<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wang Xiaoli" />


<title>AllMyHomework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">AllMyHomework</h1>
<h4 class="author">Wang Xiaoli</h4>
<h4 class="date">2023/12/3</h4>



<div id="hw0.20230917" class="section level1">
<h1>HW0.20230917</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<div id="section" class="section level3">
<h3>1.1</h3>
<p><em>Suppose that <span class="math inline">\(y_1,y2\dots y_n\)</span>
are independent from a Poisson distribution. Obtain the likelihood
function and the corresponding figure given <span class="math inline">\(n=2\)</span> and <span class="math inline">\(\bar{y}=0.5\)</span>.</em></p>
</div>
<div id="section-1" class="section level3">
<h3>1.2</h3>
<p><em>Show that the ML estimator of 1.1 is <span class="math inline">\(\hat{\mu}=\bar{y}\)</span>. And summarize the
conclusions of 1.1&amp;1.2 in a table.</em></p>
</div>
<div id="section-2" class="section level3">
<h3>1.3</h3>
<p><em>Draw a picture of Gaussian probability density.</em></p>
</div>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="section-3" class="section level3">
<h3>1.1</h3>
<p><strong>Solution.</strong></p>
<p>The probability distribution function for Poisson distribution is
given by:</p>
<p><span class="math inline">\(p(y_1,y_2\dots8
y_n)=\prod_{i=1}^np(y_i)=\prod_{i=1}^n\frac{\mu^{y_i}}{{y_i}!}e^{-\mu}=\frac{\mu^{n\bar{y}}*e^{-n\mu}}{\prod_{i=1}^ny_i!}\)</span>,</p>
<p>Simply the probability distribution and write the likelihood function
below:</p>
<p><span class="math inline">\(L(\mu)=\mu^{n\bar{y}}*e^{-n\mu}\)</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#If n=2 and \bar{y}=0.5, then the corresponding likelihood could be draw below.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>Likelihood_n2_ybar0<span class="fl">.5</span><span class="ot">&lt;-</span><span class="cf">function</span>(mu) mu<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>mu) <span class="do">## likelihood function</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">curve</span>(Likelihood_n2_ybar0<span class="fl">.5</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">xname=</span><span class="st">&quot;mu&quot;</span>) <span class="do">## curve of likelihood with respect to mu</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-4" class="section level3">
<h3>1.2</h3>
<p><strong>Solution.</strong></p>
<p>Differentiate the likelihood function with respect to <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math inline">\(\frac{\partial L(\mu)}{\partial
\mu}=n\mu^{n\bar{y}-1}e^{-n\mu}*(\bar{y}-\mu)\)</span></p>
<p>Equate the differential to zero and derive the maximum likelihood
estimator:</p>
<p><span class="math inline">\(\hat{\mu}=\bar{y}\)</span></p>
<p>Summarize those conclusions in the following table.</p>
<table>
<thead>
<tr class="header">
<th align="center">Parameters</th>
<th align="center">Likelihood</th>
<th align="center">Maximum Likelihood Estimator</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\mu\)</span></td>
<td align="center"><span class="math inline">\(\mu^{n\bar{y}}*e^{-n\mu}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="section-5" class="section level3">
<h3>1.3</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">dnorm</span>(x),<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="at">main=</span><span class="st">&quot;Normal Density&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw1.20230918" class="section level1">
<h1>HW1.20230918</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<div id="homework-in-class" class="section level3">
<h3>Homework in class</h3>
<p><em>Use the inverse transform method to replicate part of performance
of function ‘sample(replace=TRUE)’.</em></p>
</div>
<div id="section-6" class="section level3">
<h3>3.2</h3>
<p><em>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac12e^{-|x|},x\in\mathcal{R}\)</span>. Use
the inverse transform method to generate a random sample of size 1000
from this distribution. Use one of the methods shown in this chapter to
compare the generated sample to the target distribution.</em></p>
</div>
<div id="section-7" class="section level3">
<h3>3.7</h3>
<p><em>Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</em></p>
</div>
<div id="section-8" class="section level3">
<h3>3.9</h3>
<p><em>The rescaled Epanechnikov kernel is a symmetric density function
<span class="math display">\[f_e(x)=\frac34(1-x^2),\ \ |x|\le1\]</span>.
Devroye and Gyorfi give the following algorithm for simulation from this
distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\sim
Uniform(-1,1)\)</span>. If <span class="math inline">\(|U_3|\ge|U_2|\)</span> and <span class="math inline">\(|U_3|\ge|U_1|\)</span>, deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random
variates from <span class="math inline">\(f_e\)</span> and construct the
histogram density estimate of a large simulated random sample.</em></p>
</div>
<div id="section-9" class="section level3">
<h3>3.10</h3>
<p><em>Prove that the algorithm gives in Exercise 3.9 generates variates
fromthe density <span class="math inline">\(f_e\)</span>.</em></p>
</div>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="homework-in-class-1" class="section level3">
<h3>Homework in class</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mysample<span class="ot">&lt;-</span><span class="cf">function</span>(x,<span class="at">size=</span><span class="cn">NULL</span>,<span class="at">prob=</span><span class="cn">NULL</span>){</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,x) <span class="co">#first transform integer x into 1:x</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  }</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(x) <span class="co">#then derive the length of x</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(prob)){</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    prob<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">1</span>,n)<span class="sc">/</span>n <span class="co">#second, for &quot;prob=NULL&quot;, put rep(1,n) on prob</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  }</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(size)){</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    size<span class="ot">&lt;-</span><span class="fu">length</span>(x) <span class="co">#third, for &quot;size=NULL&quot;, directly set size=length(x)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  }</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  cum_prob<span class="ot">&lt;-</span><span class="fu">cumsum</span>(prob)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  cum_prob<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,cum_prob) <span class="co">#forth, obtain the cumulative sums of prob</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  </span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="do">##key point: generate the uniform distributed variables and sample x depending on corresponding cumulative sums</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(size);y<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,size) </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>size){</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    j<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>    <span class="cf">while</span>(u[i]<span class="sc">&gt;=</span>cum_prob[j]){j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    y[i]<span class="ot">=</span>x[j<span class="dv">-1</span>]</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  }</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>}</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#we could also use &quot;findInterval&quot; to find intervals  </span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">1000</span>,<span class="at">prob=</span><span class="fu">rep</span>(<span class="fl">0.5</span>,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## 
##   0   1 
## 504 496</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">10000</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>))) <span class="co">#list two examples without/with weights in large sample cases</span></span></code></pre></div>
<pre><code>## 
##    1    2    3 
## 2041 2929 5030</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(<span class="fu">c</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;a&quot;</span>),<span class="at">size=</span><span class="dv">100</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>))) <span class="co">#check for the situation that x is a vector of letters</span></span></code></pre></div>
<pre><code>## 
##  a  b  c 
## 47 18 35</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">100</span>,<span class="at">prob=</span><span class="fu">rep</span>(<span class="fl">0.25</span>,<span class="dv">4</span>))) <span class="co">#check the situation that x is an integer</span></span></code></pre></div>
<pre><code>## 
##  1  2  3  4 
## 28 24 22 26</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fu">rep</span>(<span class="fl">0.1</span>,<span class="dv">10</span>))) <span class="co">#check the funciton of &quot;size=NULL&quot;</span></span></code></pre></div>
<pre><code>## 
##  1  2  3  5  6  8 10 
##  2  2  2  1  1  1  1</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">100</span>)) <span class="co">#check the function of &quot;prob=NULL&quot;</span></span></code></pre></div>
<pre><code>## 
##  0  1 
## 43 57</code></pre>
</div>
<div id="section-10" class="section level3">
<h3>3.2</h3>
<p><strong>Solution.</strong></p>
<p>Compute the standard Laplace’s cdf:</p>
<p><span class="math inline">\(F_X(x)=\int_{-\infty}^x\frac12e^{-|y|}dy=\begin{cases}\int_{-\infty}^x\frac12e^{y}dy\
\ \ \ x\le0\ \\\frac12+\int_{0}^x\frac12e^{-y}dy\ \
x&gt;0\end{cases}=\begin{cases}\frac12e^{x}\ \ \ \
x\le0\\1-\frac12e^{-x}\ \ x&gt;0\end{cases}.\)</span></p>
<p>Then compute the inverse function of the cdf:</p>
<p><span class="math inline">\(F_X^{-1}(u)=\begin{cases}log(2u)\ \ \
u\le\frac12\\-log(2(1-u))\ \ \ u&gt;\frac12\end{cases}.\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">ifelse</span>(u<span class="sc">&lt;=</span><span class="fl">0.5</span>,<span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u),<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="co">#generate a random sample of size 1000 from the standard Laplace distribution</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="at">breaks=</span><span class="dv">100</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">1</span>,<span class="dv">2</span>)<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span><span class="fu">abs</span>(x))))</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,.<span class="dv">01</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y))) <span class="co">#compare the generated sample with the target distribution using histogram</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With the histogram above, the generated sample is approximately from
the standard Laplace distribution.</p>
</div>
<div id="section-11" class="section level3">
<h3>3.7</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>mybeta<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){ <span class="co">#see the beta(2,2) algorithm for reference</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="cf">while</span>(k<span class="sc">&lt;</span>n){</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">&gt;</span>u){ <span class="co">#accept x</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>      y[k]<span class="ot">&lt;-</span>x</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    }</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  }</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="co">#write a function to generate samples from beta(a,b) by acceptance-rejection method</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>n_sample<span class="ot">&lt;-</span><span class="dv">1000</span>;a_sample<span class="ot">&lt;-</span><span class="dv">3</span>;b_sample<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>beta_sample<span class="ot">&lt;-</span><span class="fu">mybeta</span>(n_sample,a_sample,b_sample)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  <span class="co">#give the parameters (n,a,b)=(1000,3,2) and then generate 1000 samples</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="fu">hist</span>(beta_sample,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">breaks=</span><span class="dv">50</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">1</span>,<span class="fu">B</span>(a,b))<span class="sc">*</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)))</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">^</span>(a_sample<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(b_sample<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">beta</span>(a_sample,b_sample)) <span class="co">#compare the generated sample with Beta(3,2) distribution using histogram</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-12" class="section level3">
<h3>3.9</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>myepa<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  u_seq<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">3</span><span class="sc">*</span>n,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  u_mat<span class="ot">&lt;-</span><span class="fu">matrix</span>(u_seq,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  epa<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">abs</span>(u_mat[,<span class="dv">3</span>])<span class="sc">&gt;=</span><span class="fu">abs</span>(u_mat[,<span class="dv">2</span>])<span class="sc">&amp;</span><span class="fu">abs</span>(u_mat[,<span class="dv">3</span>])<span class="sc">&gt;=</span><span class="fu">abs</span>(u_mat[,<span class="dv">1</span>]),u_mat[,<span class="dv">2</span>],u_mat[,<span class="dv">3</span>])</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">return</span>(epa)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>} </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="co">#write a function to generate variables with the algorithm in Exercise 3.9</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>n_sample<span class="ot">&lt;-</span><span class="dv">2000</span>;epa_sample<span class="ot">&lt;-</span><span class="fu">myepa</span>(n_sample) </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="co">#give a concrete set up and generate the corresponding variables </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="fu">hist</span>(epa_sample,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">breaks=</span><span class="dv">50</span>,<span class="at">main=</span><span class="fu">expression</span>(f[e](x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">3</span>,<span class="dv">4</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>)) <span class="co">#compare the generated sample with the target distribution using histogram</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-13" class="section level3">
<h3>3.10</h3>
<p><strong>Solution.</strong></p>
<p>Denote the generated variable as <span class="math inline">\(U\)</span>.</p>
<p><span class="math inline">\(P(|U|\le u)=P(|U|\le
u,|U_3|\ge\max(|U_1|,|U_2|))+P(|U|\le
u,|U_3|&lt;\max(|U_1|,|U_2|))\)</span></p>
<p><span class="math inline">\(=P(|U_2|\le
u,|U_2|\le|U_3|,|U_1|\le|U_3|)+P(|U_3|\le
u,|U_3|&lt;\max(|U_1|,|U_2|))=(*1)+(*2)\)</span>.</p>
<p><span class="math inline">\((*1)=P(\widetilde{U}_2\le
u,\widetilde{U}_2\le\widetilde{U}_3,\widetilde{U}_1\le\widetilde{U}_3)\)</span>,
where <span class="math inline">\(\widetilde{U}_1=|U_1|\)</span>, <span class="math inline">\(\widetilde{U}_2=|U_2|\)</span> and <span class="math inline">\(\widetilde{U}_3=|U_3|\)</span> are independent and
uniformly distributed from <span class="math inline">\(U(0,1)\)</span>.</p>
<p><span class="math inline">\(=\int_0^1d\widetilde{u}_3P(\widetilde{U}_2\le\min(u,\widetilde{u}_3),\widetilde{U}_1\le\widetilde{u}_3)=\int_0^1\widetilde{u}_3\min(u,\widetilde{u}_3)d\widetilde{u}_3\)</span></p>
<p><span class="math inline">\(=\int_0^u\widetilde{u}_3^2d\widetilde{u}_3+u\int_u^1\widetilde{u}_3d\widetilde{u}_3=\frac12u-\frac16u^3\)</span>.</p>
<p><span class="math inline">\((*2)=P(|U_3|\le u,|U_3|&lt;T)\)</span>,
where <span class="math inline">\(T=\max(|U_1|,|U_2|)\)</span> has the
pdf <span class="math inline">\(f_T(t)=2t,0\le t\le1\)</span></p>
<p><span class="math inline">\(=\int_0^ud\widetilde{u}_3P(T&gt;\widetilde{u}_3)=\int_0^u(1-\widetilde{u}_3^2)d\widetilde{u}_3=u-\frac13u^3\)</span>.</p>
<p>Thus, <span class="math inline">\(P(|U|\le
u)=(*1)+(*2)=\frac32u-\frac12u^3\)</span>.</p>
<p>And easily see from the algorithm that <span class="math inline">\(U\)</span> is absolutely symmetric.</p>
<p>Then derive <span class="math inline">\(P(U\le
u)=I(u\ge0)(\frac12+\frac12P(|U|\le
u))+I(u&lt;0)(\frac12P(|U|\ge-u))\)</span></p>
<p><span class="math inline">\(=-\frac14u^3+\frac34u+\frac12\)</span>.</p>
<p>Hence <span class="math inline">\(f_U(u)=-\frac34u^2+\frac34=\frac34(1-u^2),|u|\le1\)</span>.</p>
</div>
</div>
</div>
<div id="hw2.20230925" class="section level1">
<h1>HW2.20230925</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<div id="homework-in-class-2" class="section level3">
<h3>Homework in class</h3>
<p><strong>a.</strong></p>
<p><em>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat\pi\)</span>?(<span class="math inline">\(m\sim B(n,p)\)</span>,using <span class="math inline">\(\delta\)</span> method)</em></p>
<p><strong>b.</strong></p>
<p><em>Take three different values of <span class="math inline">\(\rho\)</span>(<span class="math inline">\(0\le\rho\le1\)</span>,including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo
simulation to vertify your answer.(<span class="math inline">\(n=10^6\)</span>,Number of repeated simulations
<span class="math inline">\(K=100\)</span>)</em></p>
</div>
<div id="section-14" class="section level3">
<h3>5.6</h3>
<p><em>In Example 5.7 the control variate approach was illustrated for
Monte Carlo integration of <span class="math display">\[\theta=\int_0^1e^xdx\]</span>. Now consider the
antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim Uniform(0,1)\)</span>. What is the percent
reduction in variance of <span class="math inline">\(\hat\theta\)</span>
that can be achieved using antithetic variates(compared with simple
MC)?</em></p>
</div>
<div id="section-15" class="section level3">
<h3>5.7</h3>
<p><em>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate
<span class="math inline">\(\theta\)</span> by the antithetic variate
approach and by the simple Monte Carlo method. Compute an empirical
estimate of the percent reduction in variance using the antithetic
variate. Compare the result with the theoretical value from Exercise
5.6.</em></p>
</div>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="homework-in-class-3" class="section level3">
<h3>Homework in class</h3>
<p><strong>Solution.</strong></p>
<p><strong>a.</strong></p>
<p>With the denotation of <span class="math inline">\(\rho\)</span>,
simply the formula of <span class="math inline">\(\hat\pi\)</span>:</p>
<p><span class="math inline">\(\hat\pi=\frac{2l}{d\hat{p}}=\frac{2\rho}{\hat{p}}.\)</span></p>
<p>Notice a hidden formula: <span class="math inline">\(\pi=\frac{2l}{dp}=\frac{2\rho}{p}\)</span>. This
formula also could be rewritten as <span class="math inline">\(p=\frac{2\rho}{\pi}\)</span>.</p>
<p>Then compute the asymptotic variance of <span class="math inline">\(\hat\pi\)</span> using delta method:</p>
<p><span class="math inline">\(Var(\hat\pi)=Var(\frac{2\rho}{\hat{p}})\approx(-\frac{2\rho}{p^2})^2Var(\hat{p})=\frac{4\rho^2}{p^4}\frac{p(1-p)}{m}=\frac{4\rho^2}{m}\frac{1-p}{p^3}.\)</span></p>
<p>Plug <span class="math inline">\(p\frac{2\rho}{\pi}\)</span> in the
asymptotic variance:</p>
<p><span class="math inline">\(Var(\hat\pi)=\frac{4\rho^2}{m}\frac{1-p}{p^3}=\frac{4\rho^2}{m}\frac{1-\frac{2\rho}{\pi}}{(\frac{2\rho}{\pi})^3}=\frac{\pi^2}{m}\frac{\pi-2\rho}{2\rho}.\)</span></p>
<p>Thus, the value <span class="math inline">\(\rho=1\)</span> minmizes
the asymptotic variance.</p>
<p><strong>b.</strong></p>
<p>Choose three different <span class="math inline">\(\rho\)</span>:
<span class="math inline">\(\rho=0.5,0.8,1\)</span> and use Monte Carlo
simulation to vertify the answer.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e6</span>;K<span class="ot">&lt;-</span><span class="dv">100</span> <span class="co">#number of repeated simulations</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>n_rho0<span class="fl">.5</span><span class="ot">&lt;-</span><span class="fu">rbinom</span>(K,m,<span class="dv">2</span><span class="sc">*</span><span class="fl">0.5</span><span class="sc">/</span>pi)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>n_rho0<span class="fl">.8</span><span class="ot">&lt;-</span><span class="fu">rbinom</span>(K,m,<span class="dv">2</span><span class="sc">*</span><span class="fl">0.8</span><span class="sc">/</span>pi)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>n_rho1<span class="ot">&lt;-</span><span class="fu">rbinom</span>(K,m,<span class="dv">2</span><span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>pi)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="co">#generate binomial variables with parameters (n=100,size=1e6,prob=2*[0.5/0.8/1]/pi), where prob=p=2*rho/pi</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>pi_rho0<span class="fl">.5</span><span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span><span class="fl">0.5</span><span class="sc">/</span>(n_rho0<span class="fl">.5</span><span class="sc">/</span>m)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>pi_rho0<span class="fl">.8</span><span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span><span class="fl">0.8</span><span class="sc">/</span>(n_rho0<span class="fl">.8</span><span class="sc">/</span>m)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>pi_rho1<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>(n_rho1<span class="sc">/</span>m)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="co">#generate corresponding estimates of pi with rho=0.5/0.8/1</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;variance of hat_pi with rho=0.5:&quot;</span>,<span class="fu">var</span>(pi_rho0<span class="fl">.5</span>)<span class="sc">/</span>m,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;variance of hat_pi with rho=0.8:&quot;</span>,<span class="fu">var</span>(pi_rho0<span class="fl">.8</span>)<span class="sc">/</span>m,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;variance of hat_pi with rho=1:&quot;</span>,<span class="fu">var</span>(pi_rho1)<span class="sc">/</span>m,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##  variance of hat_pi with rho=0.5: 2.130936e-11 
##  variance of hat_pi with rho=0.8: 1.031823e-11 
##  variance of hat_pi with rho=1: 6.615355e-12</code></pre>
<p>Observe these three numbers and find that variance of <span class="math inline">\(\hat\pi\)</span> is smallest. Thus, my answer in
<strong>a.</strong> has been vertified using Monte Carlo simulation.</p>
</div>
<div id="section-16" class="section level3">
<h3>5.6</h3>
<p><strong>Solution.</strong></p>
<p><span class="math inline">\(U\sim Uniform(0,1)\)</span> if and only
if <span class="math inline">\(1-U\sim Uniform(0,1)\)</span>. With <span class="math inline">\(U\sim Uniform(0,1)\)</span>, <span class="math inline">\(U\)</span> and <span class="math inline">\(1-U\)</span> are identically distributed from
<span class="math inline">\(Uniform(0,1)\)</span>. Thus, <span class="math inline">\(e^U\)</span> and <span class="math inline">\(e^{1-U}\)</span> are also identically
distributed.</p>
<p>With the knowledge of identical distributions, compute the
expectation and variance of <span class="math inline">\(e^U\)</span> and
<span class="math inline">\(e^{1-U}\)</span>:</p>
<p><span class="math inline">\(\begin{align*}&amp;Ee^{1-U}=Ee^U=\int_0^1e^udu=e-1,\\&amp;Var(e^{1-U})=Var(e^U)=Ee^{2U}-(Ee^U)^2=\int_0^1e^{2u}du-(e-1)^2=\frac12(e^2-1)-(e-1)^2\\&amp;\
\ \ \ \ =-\frac12e^2+2e-\frac32\end{align*}.\)</span></p>
<p>Then compute the covariance <span class="math inline">\(Cov(e^U,e^{1-U})\)</span>:</p>
<p><span class="math inline">\(Cov(e^U,e^{1-U})=E(e^U*e^{1-U})-E(e^U)E(e^{1-U})=e-(e-1)^2=-e^2+3e-1.\)</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span> <span class="co">#give the approximate value of the covariance</span></span></code></pre></div>
<pre><code>## [1] -0.2342106</code></pre>
<p>Further compute the variance <span class="math inline">\(Var(e^U+e^{1-U})\)</span>:</p>
<p><span class="math inline">\(\begin{align*}&amp;Var(e^U+e^{1-U})=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})\\&amp;=2(-\frac12e^2+2e-\frac32)+2(-e^2+3e-1)=-3e^2+10e-5.\end{align*}\)</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="dv">10</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">5</span> <span class="co">#give the approximate value of the variance</span></span></code></pre></div>
<pre><code>## [1] 0.01564999</code></pre>
<p>The variances of <span class="math inline">\(\hat\theta\)</span> with
simple MC and antithetic variate approaches are listed below:</p>
<p><span class="math inline">\(\begin{align*}&amp;\hat\theta_{s}=\frac1m\sum_{i=1}^me^{U_i},\
Var(\hat\theta_s)=\frac1m
Var(e^{U_1});\\&amp;\hat\theta_a=\frac1m\sum_{i=1}^{m/2}(e^{U_i}+e^{1-U_i}),\
Var(\hat\theta_a)=\frac1{2m}Var(e^{U_1}+e^{1-U_1}).\end{align*}\)</span></p>
<p>Lastly calculate the percent reduction in variance:</p>
<p><span class="math inline">\(PR=1-\frac{Var(\hat\theta_a)}{Var(\hat\theta_s)}=1-\frac{Var(e^{U_1}+e^{1-U_1})}{2Var(e^{U_1})}=\frac{2(e^2-3e+1)}{-e^2+4e-3}.\)</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="dv">6</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">3</span>) <span class="co">#give the approximate value of the percent reduction and find the antithetic variate approach works well</span></span></code></pre></div>
<pre><code>## [1] 0.9676701</code></pre>
</div>
<div id="section-17" class="section level3">
<h3>5.7</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000000</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m) <span class="co">#generate uniform variables</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>test_simpleMC<span class="ot">&lt;-</span><span class="fu">exp</span>(u) <span class="co">#simple MC</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>test_antithetic_variate<span class="ot">&lt;-</span>(<span class="fu">exp</span>(u[<span class="dv">1</span><span class="sc">:</span>m<span class="sc">/</span><span class="dv">2</span>])<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u[<span class="dv">1</span><span class="sc">:</span>m<span class="sc">/</span><span class="dv">2</span>]))<span class="sc">/</span><span class="dv">2</span> <span class="co">#antithetic variate</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;theta value:&quot;</span>,<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;theta estimate of simple MC:&quot;</span>,<span class="fu">mean</span>(test_simpleMC),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;theta estimate of antithetic variate:&quot;</span>,<span class="fu">mean</span>(test_antithetic_variate),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##  theta value: 1.718282 
##  theta estimate of simple MC: 1.718817 
##  theta estimate of antithetic variate: 1.71843</code></pre>
<p>Observe the results of theta value and theta estimates and find that
1.simple MC seems more precise than antithetic variate for same m;
2.estimates from simple MC and antithetic variate could be accurate to
the third position for m=1000000.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;theoretical value of percent reduction:&quot;</span>,(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="dv">6</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;empirical estimate of percent reduction:&quot;</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(test_antithetic_variate)<span class="sc">/</span><span class="fu">var</span>(test_simpleMC),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##  theoretical value of percent reduction: 0.9676701 
##  empirical estimate of percent reduction: 0.9838469</code></pre>
<p>Then see results of theoretical value and empirical estimate of
percent reduction and find that the empirical estimate is relatively
inaccurate, might due to fractional form of percent reduction.</p>
</div>
</div>
</div>
<div id="hw3.20231014" class="section level1">
<h1>HW3.20231014</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<div id="homework-outside-the-book" class="section level3">
<h3>Homework outside the book</h3>
<p><em><span class="math inline">\(Var(\hat{\theta}^M)=\frac1{Mk}\sum_{i=1}^k\sigma_i^2+Var(\theta_I)=Var(\hat{\theta}^S)+Var(\theta_I)\)</span>,
where <span class="math inline">\(\theta_i=E[g(U)\mid
I=i],\sigma_i^2=Var[g( U)\mid I=i]\)</span> and <span class="math inline">\(I\)</span> takes uniform distribution over <span class="math inline">\(\{1,2\dots k\}\)</span>.</em></p>
<p><em>Proof that if <span class="math inline">\(g\)</span> is a
continuous function over <span class="math inline">\((a,b)\)</span>,
then <span class="math inline">\(Var(\hat{\theta}^S)/Var(\hat{\theta}^M)\to0\)</span>
as <span class="math inline">\(b_i-a_i\to0\)</span> for all <span class="math inline">\(i=1,2\dots k\)</span>.</em></p>
</div>
<div id="section-18" class="section level3">
<h3>5.13</h3>
<p><em>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\]</span>
by importance sampling? Explain.</em></p>
</div>
<div id="section-19" class="section level3">
<h3>5.14</h3>
<p><em>Obtain a Monte Carlo estimate of <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\]</span>
by importance sampling.</em></p>
</div>
<div id="section-20" class="section level3">
<h3>5.15</h3>
<p><em>Obtain the stratified importance sampling estimate in Example
5.13 and compare it with the result of Example 5.10.</em></p>
</div>
<div id="section-21" class="section level3">
<h3>6.5</h3>
<p><em>Suppose a 95% symmetric t-interval is applied to estimate a mean,
but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
t-interval for random samples of <span class="math inline">\(\mathcal{X}^2(2)\)</span> data with sample size
<span class="math inline">\(n=20\)</span>. Compare your t-interval
results with the simualtion results in Example 6.4. (The t-interval
should be more robust to departures from normality than the interval for
variance.)</em></p>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<p><em>Use Monte Carlo simulation to investigate whether the empirical
Type I error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(\alpha\)</span>, when the
sampled population is non-normal. The t-test is robust to mild
departrues from normality. Discuss the simulation results for the cases
where the sampled population is (i)<span class="math inline">\(\mathcal{X}^2(1)\)</span>, (ii)Uniform(0,2) and
(iii)Exp(1). In each case, test <span class="math inline">\(H_0:\mu=\mu_0\ vs\ H_1:\mu\neq\mu_0\)</span>,
where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\mathcal{X}^2(1)\)</span>, Uniform(0,2) and
Exp(1), respectively.</em></p>
</div>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="homework-outside-the-book-1" class="section level3">
<h3>Homework outside the book</h3>
<p><strong>Solution.</strong></p>
<p>First, list two formulas of simple estimator and hierarchical
estimator:</p>
<p><span class="math display">\[\begin{matrix}\mathrm{Simple\
Estimator:}\hat{\theta}^M=\frac{1}{M}\sum_{i=1}^Mg(U_i),U_i\sim U(a,b);
\\\mathrm{Hierarchical\
Estimator:}\hat{\theta}^S=\frac{1}{k}\sum_{i=1}^k\hat{\theta}_i,\hat{\theta}_i=\frac{1}{m_i}\sum_{j=1}^{m_i}g(U_j^i),U_j^i\sim
U(a_i,b_i).\end{matrix}\]</span></p>
</div>
</div>
</div>
<div id="hw4.20231020" class="section level1">
<h1>HW4.20231020</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<div id="section-22" class="section level3">
<h3>1.</h3>
<p><em>Consider <span class="math inline">\(m=1000\)</span> hypotheses
among which the first 95% null hypotheses the last 5% alternative
hypotheses are true. Under the null hypothesis, p-value is uniformly
distributed with <span class="math inline">\(\mathrm{pvalue}\sim
U(0,1)\)</span>. Under the alternative hypothesis, p-value has a beta
distribution with <span class="math inline">\(\mathrm{pvalue}\sim
Beta(0.1,1)\)</span> (which could be generated with <span class="math inline">\(rbeta\)</span>). Use the bonferroni correction and
the B-H correction to generate <span class="math inline">\(m\)</span>
corrected p-values (independent) (use <span class="math inline">\(p.adjust\)</span>) and compare with <span class="math inline">\(\alpha=0.1\)</span> to justify whether to reject
the null hypothesis.</em></p>
<p><em>Based on <span class="math inline">\(M=1000\)</span>
replications, estimate <span class="math inline">\(FWER\)</span>, <span class="math inline">\(FDR\)</span> and <span class="math inline">\(TPR\)</span>, and output those results to a
table.</em></p>
</div>
<div id="section-23" class="section level3">
<h3>2.</h3>
<p><em>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=1/\bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n/(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda/(n-1)\)</span>. The standard
error <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n/[(n-1)\sqrt{n-2}]\)</span>. Conduct a
simulation study to verify the performance of the booțstrap
method.</em></p>
<p><em>The true value of <span class="math inline">\(\lambda=2\)</span>.</em></p>
<p><em>The sample size <span class="math inline">\(n=5,10,20.\)</span></em></p>
<p><em>The number of bootstrap replicates <span class="math inline">\(B=1000.\)</span></em></p>
<p><em>The simulations are repeated for <span class="math inline">\(m=1000\)</span> times.</em></p>
<p><em>Compare the mean bootstrap bias and bootstrap standard error with
the theoretical ones. Comment on the results.</em></p>
</div>
<div id="section-24" class="section level3">
<h3>3.</h3>
<p><em>Obtain a bootstrap t confidence interval estimate for the
correlation statistic in Example 7.2(law data in bootstrap).</em></p>
</div>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-25" class="section level3">
<h3>1.</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>FWER.B<span class="ot">&lt;-</span>FWER.BH<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>FDR.B<span class="ot">&lt;-</span>FDR.BH<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>TPR.B<span class="ot">&lt;-</span>TPR.BH<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">runif</span>(<span class="dv">950</span>),<span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)) <span class="co">#generate pvalues</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  p.b<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>) <span class="co">#Bonferroni adjustment</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>  p.bh<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&quot;BH&quot;</span>) <span class="co">#BH adjustment</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  FWER.B[m]<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">any</span>(p.b[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>) </span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  FWER.BH[m]<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">any</span>(p.bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>    <span class="co">#check number of [true H_0 and reject H_0] is not less than 1</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  FDR.B[m]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">ifelse</span>((p.b[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">ifelse</span>(p.b,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  FDR.BH[m]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">ifelse</span>((p.bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">ifelse</span>((p.bh<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>    <span class="co">#number of [true H_o and reject H_0]/number of [reject H_0]</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  TPR.B[m]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">ifelse</span>((p.b[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  TPR.BH[m]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">ifelse</span>((p.bh[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>    <span class="co">#number of [true H_a and reject H_0]/number of [true H_a]</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>}</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(FWER.B),<span class="fu">mean</span>(FDR.B),<span class="fu">mean</span>(TPR.B),<span class="fu">mean</span>(FWER.BH),<span class="fu">mean</span>(FDR.BH),<span class="fu">mean</span>(TPR.BH)),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="fu">rownames</span>(m)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>,<span class="st">&quot;BH&quot;</span>)</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="fu">colnames</span>(m)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>m <span class="co">#print results with matrix</span></span></code></pre></div>
<pre><code>##             FWER        FDR     TPR
## Bonferroni 0.097 0.00010000 0.39720
## BH         0.936 0.09639987 0.56456</code></pre>
</div>
<div id="section-26" class="section level3">
<h3>2.</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co">#sample size:n=5</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>la<span class="ot">&lt;-</span><span class="dv">2</span>;n<span class="ot">&lt;-</span><span class="dv">5</span>;x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,la)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>lambdabias<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>lambdasd<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>  <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>    lambdastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  }  </span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  lambdabias[m]<span class="ot">&lt;-</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>  lambdasd[m]<span class="ot">&lt;-</span><span class="fu">sd</span>(lambdastar)</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>}</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.boot=</span><span class="fu">mean</span>(lambdabias),<span class="at">se.boot=</span><span class="fu">mean</span>(lambdasd)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias.boot   se.boot 
##    0.5490    1.8932</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.thm=</span>la<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">se.thm=</span>la<span class="sc">*</span>n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias.thm   se.thm 
##   0.5000   1.4434</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co">#sample size:n=10</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>la<span class="ot">&lt;-</span><span class="dv">2</span>;n<span class="ot">&lt;-</span><span class="dv">10</span>;x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,la)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>lambdabias<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>lambdasd<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>    lambdastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>  }  </span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>  lambdabias[m]<span class="ot">&lt;-</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>  lambdasd[m]<span class="ot">&lt;-</span><span class="fu">sd</span>(lambdastar)</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>}</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.boot=</span><span class="fu">mean</span>(lambdabias),<span class="at">se.boot=</span><span class="fu">mean</span>(lambdasd)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias.boot   se.boot 
##    0.2327    0.8600</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.thm=</span>la<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">se.thm=</span>la<span class="sc">*</span>n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias.thm   se.thm 
##   0.2222   0.7857</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co">#sample size:n=20</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>la<span class="ot">&lt;-</span><span class="dv">2</span>;n<span class="ot">&lt;-</span><span class="dv">20</span>;x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,la)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>lambdabias<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>lambdasd<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>  <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>    lambdastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  }  </span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  lambdabias[m]<span class="ot">&lt;-</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>  lambdasd[m]<span class="ot">&lt;-</span><span class="fu">sd</span>(lambdastar)</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>}</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.boot=</span><span class="fu">mean</span>(lambdabias),<span class="at">se.boot=</span><span class="fu">mean</span>(lambdasd)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias.boot   se.boot 
##    0.0782    0.4001</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.thm=</span>la<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">se.thm=</span>la<span class="sc">*</span>n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias.thm   se.thm 
##   0.1053   0.4962</code></pre>
<p>1.mean bootstrap bias&amp;mean bootstrap standard error and
theoretical bias&amp;standard error decrease when n increases from 5 to
20;</p>
<p>2.bias and standard error differences between bootstrap and theory
decrease when n increases from 5 to 20;</p>
<p>3.bootstrap bias/se and theoretical bias/se are relatively close.</p>
</div>
<div id="section-27" class="section level3">
<h3>3.</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co">#select alpha as 0.05</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>theta.b<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>theta.sd.b<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>theta.bm<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">cor</span>(law<span class="sc">$</span>LSAT,law<span class="sc">$</span>GPA)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">size=</span><span class="dv">15</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  LSAT<span class="ot">&lt;-</span>law<span class="sc">$</span>LSAT[index]</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>  GPA<span class="ot">&lt;-</span>law<span class="sc">$</span>GPA[index]</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>  theta.b[b]<span class="ot">&lt;-</span><span class="fu">cor</span>(LSAT,GPA)</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>    indexx<span class="ot">&lt;-</span><span class="fu">sample</span>(index,<span class="at">size=</span><span class="dv">15</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>    LSAT<span class="ot">&lt;-</span>law<span class="sc">$</span>LSAT[indexx]</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>    GPA<span class="ot">&lt;-</span>law<span class="sc">$</span>GPA[indexx]</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>    theta.bm[m]<span class="ot">&lt;-</span><span class="fu">cor</span>(LSAT,GPA)</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>  }</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>  theta.sd.b[b]<span class="ot">&lt;-</span><span class="fu">sd</span>(theta.bm)</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>}</span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>tstar1<span class="ot">&lt;-</span><span class="fu">quantile</span>((theta.b<span class="sc">-</span>theta)<span class="sc">/</span>theta.sd.b,<span class="fl">0.025</span>)</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>tstar2<span class="ot">&lt;-</span><span class="fu">quantile</span>((theta.b<span class="sc">-</span>theta)<span class="sc">/</span>theta.sd.b,<span class="fl">0.975</span>)</span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>theta.sd<span class="ot">&lt;-</span><span class="fu">sd</span>(theta.b)</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap t confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,theta<span class="sc">-</span>tstar2<span class="sc">*</span>theta.sd,<span class="st">&quot;,&quot;</span>,theta<span class="sc">-</span>tstar1<span class="sc">*</span>theta.sd,<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bootstrap t confidence interval estimate: 
##  [ -0.09858257 , 0.9577434 ]</code></pre>
</div>
</div>
</div>
<div id="hw5.20231029" class="section level1">
<h1>HW5.20231029</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<div id="section-28" class="section level3">
<h3>7.5</h3>
<p><em>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals
for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile and BCa methods. Compare the intervals and explain why they
may differ.</em></p>
</div>
<div id="section-29" class="section level3">
<h3>7.8</h3>
<p><em>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</em></p>
</div>
<div id="section-30" class="section level3">
<h3>7.11</h3>
<p><em>In Example 7.18, leave-one-out(n-fold) cross validation was used
to select the best fitting model. Use leave-two-out cross validation to
compare the models</em></p>
</div>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-31" class="section level3">
<h3>7.5</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co">#standard normal, basic, percentile and BCa</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="co">#not use function boot.ci</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="co">#select alpha as 0.05</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>mt<span class="ot">&lt;-</span><span class="fu">mean</span>(aircondit[,<span class="dv">1</span>])</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>mt.b<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">12</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>  mt.b[b]<span class="ot">&lt;-</span><span class="fu">mean</span>(aircondit[index,<span class="dv">1</span>])</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>}</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>mt.sd<span class="ot">&lt;-</span><span class="fu">sd</span>(mt.b)</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>z0.hat<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fu">mean</span>(mt.b<span class="sc">&lt;</span>mt))</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>a.hat<span class="ot">&lt;-</span><span class="fu">sum</span>((mt<span class="sc">-</span>mt.b)<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">6</span><span class="sc">*</span><span class="fu">sum</span>(((mt<span class="sc">-</span>mt.b)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>))) </span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>  <span class="co">#still questioning</span></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>alpha1<span class="ot">&lt;-</span><span class="fu">pnorm</span>(z0.hat<span class="sc">+</span>(z0.hat<span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>a.hat<span class="sc">*</span>(z0.hat<span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>))))</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>alpha2<span class="ot">&lt;-</span><span class="fu">pnorm</span>(z0.hat<span class="sc">+</span>(z0.hat<span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>a.hat<span class="sc">*</span>(z0.hat<span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))))</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;standard normal bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,mt<span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>mt.sd,<span class="st">&quot;,&quot;</span>,mt<span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>)<span class="sc">*</span>mt.sd,<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## standard normal bootstrap confidence interval estimate: 
##  [ 36.26655 , 179.9001 ]</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;basic bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,<span class="dv">2</span><span class="sc">*</span>mt<span class="sc">-</span><span class="fu">quantile</span>(mt.b,<span class="fl">0.975</span>),<span class="st">&quot;,&quot;</span>,<span class="dv">2</span><span class="sc">*</span>mt<span class="sc">-</span><span class="fu">quantile</span>(mt.b,<span class="fl">0.025</span>),<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## basic bootstrap confidence interval estimate: 
##  [ 28.4875 , 171.4187 ]</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;percentile bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,<span class="fu">quantile</span>(mt.b,<span class="fl">0.025</span>),<span class="st">&quot;,&quot;</span>,<span class="fu">quantile</span>(mt.b,<span class="fl">0.975</span>),<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## percentile bootstrap confidence interval estimate: 
##  [ 44.74792 , 187.6792 ]</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,<span class="fu">quantile</span>(mt.b,alpha1),<span class="st">&quot;,&quot;</span>,<span class="fu">quantile</span>(mt.b,alpha2),<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## BCa bootstrap confidence interval estimate: 
##  [ 43.78149 , 184.3434 ]</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co">#standard normal, basic, percentile and BCa</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="co">#use function boot.ci</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a><span class="co">#select alpha as 0.05</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>boot.mean<span class="ot">&lt;-</span><span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>mt.boot<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>aircondit[,<span class="dv">1</span>],<span class="at">statistic=</span>boot.mean,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(mt.boot,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;standard normal bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,ci.norm[<span class="dv">1</span>],<span class="st">&quot;,&quot;</span>,ci.norm[<span class="dv">2</span>],<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## standard normal bootstrap confidence interval estimate: 
##  [ 32.58607 , 181.3593 ]</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;basic bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,ci.basic[<span class="dv">1</span>],<span class="st">&quot;,&quot;</span>,ci.basic[<span class="dv">2</span>],<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## basic bootstrap confidence interval estimate: 
##  [ 24.37356 , 168.0727 ]</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;percentile bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,ci.perc[<span class="dv">1</span>],<span class="st">&quot;,&quot;</span>,ci.perc[<span class="dv">2</span>],<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## percentile bootstrap confidence interval estimate: 
##  [ 48.09392 , 191.7931 ]</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa bootstrap confidence interval estimate:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,ci.bca[<span class="dv">1</span>],<span class="st">&quot;,&quot;</span>,ci.bca[<span class="dv">2</span>],<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## BCa bootstrap confidence interval estimate: 
##  [ 57.19471 , 239.1114 ]</code></pre>
<table>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">standard normal</th>
<th align="center">basic</th>
<th align="center">percentile</th>
<th align="center">BCa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">without boot.ci</td>
<td align="center">[33.49673,182.6699]</td>
<td align="center">[27.74792,168.4583]</td>
<td align="center">[47.70833,188.4187]</td>
<td align="center">[50.41667,195.0467]</td>
</tr>
<tr class="even">
<td align="center">with boot.ci</td>
<td align="center">[32.58607,181.3593]</td>
<td align="center">[24.37356,168.0727]</td>
<td align="center">[48.09392,191.7931]</td>
<td align="center">[57.19471,239.1114]</td>
</tr>
</tbody>
</table>
<p><em>Observations between Methods with boot.ci or without
boot.ci</em></p>
<p>Observe this table and find standard normal, basic and percentile
bootstrap confidence interval estimates are respectively equivalent
between methods with boot.ci or without boot.ci.</p>
<p>But BCa bootstrap confidence interval estimate with boot.ci is
obviously different from the estimate without boot.ci.</p>
<p>Actually, formula of <span class="math inline">\(\hat{a}\)</span> in
ppt or book has little mistake. Here I justify <span class="math inline">\(\hat{a}=\frac{\sum_{i=1}^n(\bar{\theta}_{(.)}-\theta_i)^3}{6\sum_{i=1}^n((\bar{\theta}_{(.)}-\theta_i)^2)^{3/2}}\)</span>
with <span class="math inline">\(\hat{a}=\frac{\sum_{i=1}^n(\bar{\theta}_{(.)}-\theta_i)^3}{6(\sum_{i=1}^n(\bar{\theta}_{(.)}-\theta_i)^2)^{3/2}}\)</span>.</p>
<p>With this justification, BCa bootstrap confidence interval estimate
without boot.ci is significantly lower than the estimate with boot.ci.
And I leave this inconsistence for a moment and directly use BCa
estimate with boot.ci.</p>
<p><em>Comparisons between Standard Normal, Basic, Percentile and BCa
Methods</em></p>
<p>Obviously exponential distribution is asymmetry. Thus standard normal
method is improper to this problem.</p>
<p>Furthermore, due to left skewness of exponential distribution,
standard normal interval of <span class="math inline">\(1/\lambda\)</span> might be overestimated.</p>
<p>According to slides, percentile &amp; BCa methods are both based on
<span class="math inline">\(\hat{\theta}^*|X\)</span> and <span class="math inline">\(\hat{\theta}\)</span> have approximately same
distribution and basic method is based on <span class="math inline">\(\hat{\theta}^*-\hat{\theta}|X\)</span> and <span class="math inline">\(\hat{\theta}-\theta\)</span> have same asymptotic
distribution. And percentile &amp; BCa methods have more exaggerated
approximation than basic method.</p>
<p>Thus, we prefer to trust basic method rather than percentile &amp;
BCa method.</p>
<p>Observe this table above and conclude that 1.both standard normal,
percentile and BCa methods overestimate interval of <span class="math inline">\(1/\lambda\)</span> and 2.basic confidence interval
is best.</p>
</div>
<div id="section-32" class="section level3">
<h3>7.8</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(scor[,<span class="dv">1</span>])</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">var</span>(scor))<span class="sc">$</span>values</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalues)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>theta.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  scor.jack<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  eigenvalues.jack<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">var</span>(scor.jack))<span class="sc">$</span>values</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  theta.jack[i]<span class="ot">&lt;-</span>eigenvalues.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalues.jack)</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>}</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>bias.jack<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>se.jack<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;estimate of theta:&quot;</span>,theta.hat,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## estimate of theta: 0.619115</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;jackknife estimate of bias&quot;</span>,bias.jack,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## jackknife estimate of bias 0.001069139</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;jackknife estimate of standard error&quot;</span>,se.jack,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## jackknife estimate of standard error 0.04955244</code></pre>
</div>
<div id="section-33" class="section level3">
<h3>7.11</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co">#refer to leave-one-out cross validation in Example 7.18</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="co">#use leave-two-out cross validation here</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(ironslag[,<span class="dv">1</span>])</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>chemical<span class="ot">&lt;-</span>ironslag[,<span class="dv">1</span>]</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>magnetic<span class="ot">&lt;-</span>ironslag[,<span class="dv">2</span>]</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>e1<span class="ot">&lt;-</span>e2<span class="ot">&lt;-</span>e3<span class="ot">&lt;-</span>e4<span class="ot">&lt;-</span><span class="fu">numeric</span>((n<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">/</span><span class="dv">2</span>);k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>    x<span class="ot">&lt;-</span>chemical[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>    y<span class="ot">&lt;-</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>  </span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>    J1<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>    yhat1<span class="ot">&lt;-</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>    e1[k]<span class="ot">&lt;-</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)]<span class="sc">-</span>yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>  </span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>    J2<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>    yhat2<span class="ot">&lt;-</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>    e2[k]<span class="ot">&lt;-</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)]<span class="sc">-</span>yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a>  </span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>    J3<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span>x)</span>
<span id="cb69-24"><a href="#cb69-24" tabindex="-1"></a>    logyhat3<span class="ot">&lt;-</span>J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb69-25"><a href="#cb69-25" tabindex="-1"></a>    yhat3<span class="ot">&lt;-</span><span class="fu">exp</span>(logyhat3)</span>
<span id="cb69-26"><a href="#cb69-26" tabindex="-1"></a>    e3[k]<span class="ot">&lt;-</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)]<span class="sc">-</span>yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-27"><a href="#cb69-27" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" tabindex="-1"></a>    J4<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span><span class="fu">log</span>(x))</span>
<span id="cb69-29"><a href="#cb69-29" tabindex="-1"></a>    logyhat4<span class="ot">&lt;-</span>J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[<span class="fu">c</span>(i,j)])</span>
<span id="cb69-30"><a href="#cb69-30" tabindex="-1"></a>    yhat4<span class="ot">&lt;-</span><span class="fu">exp</span>(logyhat4)</span>
<span id="cb69-31"><a href="#cb69-31" tabindex="-1"></a>    e4[k]<span class="ot">&lt;-</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)]<span class="sc">-</span>yhat4)<span class="sc">^</span><span class="dv">2</span>)  </span>
<span id="cb69-32"><a href="#cb69-32" tabindex="-1"></a>  }</span>
<span id="cb69-33"><a href="#cb69-33" tabindex="-1"></a>}</span>
<span id="cb69-34"><a href="#cb69-34" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;prediction error estimates with leave-two-out:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="fu">c</span>(<span class="fu">mean</span>(e1),<span class="fu">mean</span>(e2),<span class="fu">mean</span>(e3),<span class="fu">mean</span>(e4)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## prediction error estimates with leave-two-out: 
##  39.14455 35.74037 36.90983 40.93436</code></pre>
<p>According to those prediction error estimates with leave-two-out,
Model 2(quadratic model) would be the best fit, which is equivalent to
leave-one-out method.</p>
</div>
</div>
</div>
<div id="hw6.20231105" class="section level1">
<h1>HW6.20231105</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<div id="homework-in-class-4" class="section level3">
<h3>Homework In Class</h3>
<p><em>Prove the stationarity of Metropolis-Hastings sampler Algorithm
in continuous situation</em></p>
</div>
<div id="section-34" class="section level3">
<h3>8.1</h3>
<p><em>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</em></p>
</div>
<div id="section-35" class="section level3">
<h3>8.3</h3>
<p><em>The Count 5 test for equal variances in Section 6.4 is based on
the maximum number of extreme points. Example 6.15 shows thatthe Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</em></p>
</div>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="homework-in-class-5" class="section level3">
<h3>Homework In Class</h3>
<p><strong>Solution.</strong></p>
<p>To prove the stationarity of the MH sampler, we only need to show
that the corresponding detailed balance equation holds, which is a basic
fact that detailed balance equation is a sufficient condition of
stationarity of Markov Chains in discrete or continuous state space.</p>
<p>Write the transition kernel in continuous state space(neglect the
situation that state <span class="math inline">\(x\)</span> transits to
state <span class="math inline">\(y\)</span>;probability of this
situation is zero): <span class="math inline">\(p(x,y)=q(x,y)\alpha(x,y)\)</span>.</p>
<p>Recall the probability of acceptance <span class="math inline">\(\alpha(x,y)=min\{\frac{\phi(y)q(y,x)}{\phi(x)q(x,y)},1\}\)</span>.</p>
<p>Prove the detailed balance equation:</p>
<p><span class="math inline">\(\phi(x)p(x,y)=\phi(x)q(x,y)\alpha(x,y)=\phi(x)q(x,y)min\{\frac{\phi(y)q(y,x)}{\phi(x)q(x,y)},1\}=min\{\phi(x)q(x,y),\phi(y)q(y,x)\}\)</span></p>
<p><span class="math inline">\(=\phi(y)q(y,x)min\{\frac{\phi(x)q(x,y)}{\phi(y)q(y,x)},1\}=\phi(y)q(y,x)\alpha(y,x)=\phi(y)p(y,x).\)</span></p>
</div>
<div id="section-36" class="section level3">
<h3>8.1</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed<span class="sc">==</span><span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[feed<span class="sc">==</span><span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co">#Apply Cramer-von Mises statistic to data in Examples 8.1 and 8.2.</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="co">#Refer to codes of Example 8.1.</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y) <span class="co">#pooled sample</span></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>;reps<span class="ot">&lt;-</span><span class="fu">numeric</span>(R) <span class="co"># storage for replicates</span></span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>CM<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){ <span class="co">#Cramer-von Mises</span></span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(x);m<span class="ot">&lt;-</span><span class="fu">length</span>(y);W2<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>    W2<span class="ot">&lt;-</span>W2<span class="sc">+</span>((<span class="fu">sum</span>(x<span class="sc">&lt;=</span>x[i])<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">sum</span>(y<span class="sc">&lt;=</span>x[i])<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(m<span class="sc">+</span><span class="dv">1</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>    W2<span class="ot">&lt;-</span>W2<span class="sc">+</span>((<span class="fu">sum</span>(x<span class="sc">&lt;=</span>y[j])<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">sum</span>(y<span class="sc">&lt;=</span>y[j])<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(m<span class="sc">+</span><span class="dv">1</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>  W2<span class="sc">*</span>m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>}</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>CM0<span class="ot">&lt;-</span><span class="fu">CM</span>(x,y)</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">sample</span>(K,<span class="at">size=</span><span class="dv">14</span>,<span class="at">replace=</span><span class="cn">FALSE</span>) <span class="co">#generate index for first sample</span></span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>  xx<span class="ot">&lt;-</span>z[k];yy<span class="ot">&lt;-</span>z[<span class="sc">-</span>k] <span class="co">#complement of xx</span></span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a>  reps[i]<span class="ot">&lt;-</span><span class="fu">CM</span>(xx,yy)</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>}</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">c</span>(CM0,reps)<span class="sc">&gt;=</span>CM0);<span class="fu">cat</span>(<span class="st">&quot;Derive p-value with Cramer-von Mises statistic:&quot;</span>,p,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Derive p-value with Cramer-von Mises statistic: 0.393</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co">#Refer to codes of Example 8.1.</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="fu">hist</span>(reps,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">xlab=</span><span class="st">&quot;CM(p=0.393)&quot;</span>,<span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a><span class="fu">points</span>(CM0,<span class="dv">0</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">pch=</span><span class="dv">16</span>) <span class="co">#observed CM</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOjoAOpAAZmYAZrY6AAA6ADo6AGY6kNtmAABmADpmAGZmZgBmkJBmtv+QOgCQOjqQZgCQtpCQ2/+2ZgC2/7a2/9u2///T09PbkDrb////tmb/trb/25D//7b//9v///+9GLTFAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAID0lEQVR4nO2d22KjNhRFSZraGXvaiduGNiHUmP//yNENjLBhSyAPQuz1EmPDMV7RBcFBZDUZJVt6B2KHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB/ATlzx/1eZ9lT+8P2p348BKk/LwKOdXx7VE7FBs+gqrjQUjayZfFy9eDdig2/AS91ZfTQb4sRVnqRmkJunMx4FfFROkpRkuQFS4JaV57Xx2fP1QRKodaaVvQp2JDgoQZXSZ2TuG2KMgrHAWBcBQEwlEQCEdBIBwFgXAUBMJREAhHQSAcBYFwFATCURAIR0EgHAVdo9w9YUZBIBwFgXAUBMJREAhHQSAcBYFwFATCURAIR0EgXFqCquPw1a4J4dRCUoLquhAjhUO4cOkJqgM4Sl2QVmRnbkwPl54geeVdZrhMT/5JWZBopTNtpgRF6LwfzC9LWFB1hImHUmHDgMO7gladJXQV9F37GSs+pW7BfUvQqsvRjaBirH5VR1kJbwWNn1FMQVB+/Ynj3XwuKuK2SxCiyA7bFOTMef8bBY1yOWWbE1QdD20fPuM4Ol1BjwlHQSBcYoLknRhFM9qYH65OTlD+8nXe78zNKvPD1akJkneqlKJ7QiNVx3BqITlB8n6w0aGGezi1kJQgUbfkSKs6sopZWOeDnt4vp3ln7lMWFD4cBYFwiQkSQywONW7pNNJzLmYkf8LM3NIcLpxaSExQiFvhExY0t4PvhmvqW1KC1DgjUDjLTCqCQp4wS1JQyHAUBMIlKkhUspevfF5nn7Kg8um9kKP5APlBSQqSc3LIKUtCnA9KUpA8UJSCQpxRvCtopUkeNyUon3XWfkTQ5zoLUr8NKuYdLqYsSB8qzpy+LWlBDhQqibEeziLauKBClC99Vn+DgvRYbLSF1hO8qSTY7QnKTdUZSzBrThmJjq4YnQUvQUHtrG0j2WPNFIHyEtrWSlDnbNnYtflGi6iOGxPUGYGNDjWao6TLaXOC2or1sKEGBV3DURAIR0EgXIqC4G0qPuHSExQ4HAWBcGOC1nba7JcLWls5oiAABQEoCEBBgIUEraczC7OPHifMrIUgX/5YFipBFERBY+EoCIRzFrSCpnpZQSsoRxQEoCAABQEoCBCDoKg7sxgEfcZckCgIEJGgOCua3w7BuxKHBPVv/YENUjS2/DLMmuyhciiNaEDQ9eYo1+IUTa3z2Yc2Pwg9JbMvqHP7mJ+gYczXPb6g+QQfvkDdP2EWNY8T5FCCBr5kyp5FgmcbZIrQYBs09C2r9ePZizVJDt63K6zWT+jjoPR4iKBF2l5nYhA05aPlPwmx+uygy2ugoMmfhFh9dtDlNVDQ5E9CrD476PIaKGjyJyFWnx10eQ0UNPmTEKtvDwoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQIKajsTmBVOs5m1V/PZQ41a5t20ifE+VuTT6CyeByvDQcUJGeQaWeRsRZcN5LLDldtrW3kpE9O8/RWxybh4nIS2xSODyYOJ0inNpjJY6wF141qMxuo3xftnL5IlrpGkJ4CyHHCyHCCrK913Yf+esXL31CQtY2roDI79FJ2XMp3HVTQq/xCsxfWgutGahG3QfY2zlWsvzeOc/iHE6T/I+b/Yi24bqQqDxbUi+3aG/QEuWbwRCXIbSZQextZEM57lx9rCSpdHx4fUxVTC55VzKPB7e6NewZYTI10YfJTQINibeNaVGtL0OhkfzaRdfMuJcjaRttymvToupLPhLWxHSi6HElb20xog9xWN4QcahS6P9GHJoVj52JtVLsNNaxtctdhgxIktzFV+VcfByUKBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCLCUIJWJKy/Dixf6ynppFu8mXvQTf/VC/0X1fd5jdO+xkCCdwJSLXyUE6XSFXP0t7mbM2Im/zx96QW6u0l/ad8pZD6q+yzKCzLM45SNbL6ff1f+9+uNP8es688h1sDKC1PMYZZKGfjBj8fLVvjNU/uawjKBmjrj/P+QPy+UPLVUCsExROb/+s7czWm7z1aSOfgLorhM4HIsI6jy1VL5WFSM/yMwgWUrO++xNZfaKFzqP5zbjsWjrXJMCXLjn4nmxiKDOU0ulIHkThWhfc1NZdAJYtyz0ExFLVcBMuVKCSlPkxp6jO40YBMmWQ5QiJeitTTvs3sBxUzrUA6d1I90++lUa7UYOQwxVTHZduUohV25MherouJNUrLuxLHv+t+na1TuJCGrrj2hApKDzt//+eq/bEtQIurZBt0nFbV1qb3JS76QiyOrmd+LvD/Ez7Taom8w5lvhbmHKn30mkDTIHiuq+LVXdcnljwLUXu7k/xU78FetJZdVx11Q1804yvVhtJj3VY4ud6avz5jho/2PfT7e/Sfx9MzG0kOadVI6DhpGN0Ixqcv9AfBaRCZId2gxByYzFhhHHRNMFJTSaXw8UBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPAT70HJ88QhUwMAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-37" class="section level3">
<h3>8.3</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>Count5<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){ <span class="co">#Count 5 Test</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>  X<span class="ot">&lt;-</span>x<span class="sc">-</span><span class="fu">mean</span>(x);Y<span class="ot">&lt;-</span>y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  outx<span class="ot">&lt;-</span><span class="fu">sum</span>(X<span class="sc">&gt;</span><span class="fu">max</span>(Y))<span class="sc">+</span><span class="fu">sum</span>(X<span class="sc">&lt;</span><span class="fu">min</span>(Y))</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  outy<span class="ot">&lt;-</span><span class="fu">sum</span>(Y<span class="sc">&gt;</span><span class="fu">max</span>(X))<span class="sc">+</span><span class="fu">sum</span>(Y<span class="sc">&lt;</span><span class="fu">min</span>(X))</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  <span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy))<span class="sc">&gt;</span><span class="dv">5</span>)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>}</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>Count5.PermTest<span class="ot">&lt;-</span><span class="cf">function</span>(x,y,<span class="at">rep=</span><span class="dv">999</span>){ </span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>  <span class="co">#Permutation Test With Count 5</span></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>  Count5<span class="fl">.0</span><span class="ot">&lt;-</span><span class="fu">Count5</span>(x,y)</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y);K<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(z));C<span class="ot">&lt;-</span><span class="fu">numeric</span>(rep)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep){</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>    k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">length</span>(z),<span class="at">size=</span><span class="fu">length</span>(x),<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>    xx<span class="ot">&lt;-</span>z[k];yy<span class="ot">&lt;-</span>z[<span class="sc">-</span>k]</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>    C[i]<span class="ot">&lt;-</span><span class="fu">Count5</span>(xx,yy)</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a>  }</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">c</span>(Count5<span class="fl">.0</span>,C))</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>}</span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a><span class="co">#Simulation</span></span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a><span class="co">#Empirical Type I error: reject true H0</span></span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a><span class="co">#Same variance of normal distribution</span></span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a><span class="co">#Set mu1=1,mu2=2 and (n1,n2)={(50,50),(50,60),(50,70)}</span></span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">3</span>);n2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>)</span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a>mu1<span class="ot">&lt;-</span><span class="dv">1</span>;mu2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span>;sigma2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb75-28"><a href="#cb75-28" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb75-29"><a href="#cb75-29" tabindex="-1"></a>tests<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb75-30"><a href="#cb75-30" tabindex="-1"></a>  C5P<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb75-31"><a href="#cb75-31" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb75-32"><a href="#cb75-32" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n1[i])</span>
<span id="cb75-33"><a href="#cb75-33" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n2[i])</span>
<span id="cb75-34"><a href="#cb75-34" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1[i],mu1,sigma1)</span>
<span id="cb75-35"><a href="#cb75-35" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2[i],mu2,sigma2)</span>
<span id="cb75-36"><a href="#cb75-36" tabindex="-1"></a>    C5P[i]<span class="ot">&lt;-</span><span class="fu">Count5.PermTest</span>(x,y)</span>
<span id="cb75-37"><a href="#cb75-37" tabindex="-1"></a>  }</span>
<span id="cb75-38"><a href="#cb75-38" tabindex="-1"></a>  C5P</span>
<span id="cb75-39"><a href="#cb75-39" tabindex="-1"></a>})</span>
<span id="cb75-40"><a href="#cb75-40" tabindex="-1"></a>type1error.hat<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(tests)</span>
<span id="cb75-41"><a href="#cb75-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error of permutation test of Count 5&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;with (n1,n2)={(50,50),(50,60),(50,70)}:&quot;</span>,type1error.hat,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Empirical Type I error of permutation test of Count 5 
##  with (n1,n2)={(50,50),(50,60),(50,70)}: 0.08191 0.09387 0.12126</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co">#Empirical Power: not reject false H0</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="co">#Differing variance of normal distribution</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="co">#Also set mu1=1,mu2=2 and (n1,n2)={(50,50),(50,60),(50,70)}</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">3</span>);n2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>mu1<span class="ot">&lt;-</span><span class="dv">1</span>;mu2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span>;sigma2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>tests<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>  C5P<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n1[i])</span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n2[i])</span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1[i],mu1,sigma1)</span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2[i],mu2,sigma2)</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>    C5P[i]<span class="ot">&lt;-</span><span class="fu">Count5.PermTest</span>(x,y)</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>  }</span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>  C5P</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a>})</span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a>power.hat<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span><span class="fu">rowMeans</span>(tests)</span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Power of permutation test of Count 5:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;with (n1,n2)={(50,50),(50,60),(50,70)}&quot;</span>,power.hat,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Empirical Power of permutation test of Count 5: 
##  with (n1,n2)={(50,50),(50,60),(50,70)} 0.91206 0.90631 0.87947</code></pre>
<p>Observe that 1.empirical Type I error increases with growing
difference of two sample sizes; 2.empirical power decreases with growing
difference of two sample sizes.</p>
<p>With these two observations, we conclude that 1.performance of
permutation test of Count 5 becomes less powerful with growing
difference of two sample sizes; 2.but the test with relative little
difference of sample sizes still works comparably well.</p>
</div>
</div>
</div>
<div id="hw7.20231112" class="section level1">
<h1>HW7.20231112</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<div id="homework-in-class-6" class="section level3">
<h3>Homework In Class</h3>
<p><em>Consider a model <span class="math inline">\(P(Y=1|X_1,X_2,X_3)=\frac{exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>
where <span class="math inline">\(X_1\sim P(1),X_2\sim Exp(1)\)</span>
and <span class="math inline">\(X_3\sim B(1,0.5)\)</span>.</em></p>
<p><strong>a.</strong></p>
<p><em>Design a function that takes as input values <span class="math inline">\(N,b_1,b_2,b_3\)</span> and <span class="math inline">\(f_0\)</span> and produces the output <span class="math inline">\(a\)</span>.</em></p>
<p><strong>b.</strong></p>
<p><em>Call this function. Input values are <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>.</em></p>
<p><strong>c.</strong></p>
<p><em>Plot <span class="math inline">\(-\log f_0\)</span> vs <span class="math inline">\(a\)</span>.</em></p>
</div>
<div id="section-38" class="section level3">
<h3>9.4</h3>
<p><em>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</em></p>
</div>
<div id="section-39" class="section level3">
<h3>9.7</h3>
<p><em>Implement a Gibbs sampler to generate a bivariate normal chain
<span class="math inline">\((X_t,Y_t)\)</span> with zero means, unit
standard deviations and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</em></p>
</div>
<div id="section-40" class="section level3">
<h3>9.10</h3>
<p><em>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain and run the chain until the chain has converged
approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>. (See Exercise 9.9.) Also
use the coda [212] package to check for convergence of the chain by the
Gelman-Rubin method. (See Exercises 9.9 and 9.10.)</em></p>
</div>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="homework-in-class-7" class="section level3">
<h3>Homework In Class</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co">#a.Design a function with inputs N,b1,b2,b3,f0 to produce a </span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>a.generator<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="at">lambda=</span><span class="dv">1</span>)</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  x3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  p.alpha<span class="ot">&lt;-</span><span class="cf">function</span>(alpha){</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>    p<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3))</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>    <span class="fu">mean</span>(p)<span class="sc">-</span>f0</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  }</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>  solu<span class="ot">&lt;-</span><span class="fu">uniroot</span>(p.alpha,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">unlist</span>(solu),<span class="dv">5</span>)</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a><span class="co">#Set input values as N=10^6,b1=0,b2=1,b3=-1,f0=0.1,0.01,0.001,0.0001</span></span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a><span class="co">#Derive corresponding alpha for each setting</span></span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000000</span></span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="dv">0</span>;b2<span class="ot">&lt;-</span><span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;f0=0.1&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;f0=0.1&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">a.generator</span>(N,b1,b2,b3,f0[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>##       root     f.root       iter    init.it estim.prec 
##   -3.16854    0.00000   10.00000         NA    0.00008</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;f0=0.01&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;f0=0.01&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">a.generator</span>(N,b1,b2,b3,f0[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>##       root     f.root       iter    init.it estim.prec 
##   -6.07909    0.00000   12.00000         NA    0.00006</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;f0=0.001&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;f0=0.001&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">a.generator</span>(N,b1,b2,b3,f0[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##       root     f.root       iter    init.it estim.prec 
##   -8.72683    0.00000   14.00000         NA    0.00006</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;f0=0.0001&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;f0=0.0001&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">a.generator</span>(N,b1,b2,b3,f0[<span class="dv">4</span>])</span></code></pre></div>
<pre><code>##       root     f.root       iter    init.it estim.prec 
##  -11.24743    0.00000   13.00000         NA    0.00006</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#Plot -logf0 vs a</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>neglogf0.vs.a<span class="ot">&lt;-</span><span class="cf">function</span>(neglogf0){</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">a.generator</span>(N,b1,b2,b3,<span class="fu">exp</span>(<span class="sc">-</span>neglogf0))[<span class="dv">1</span>])</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>}</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>nlf0<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">2.3</span>,<span class="fl">9.2</span>,<span class="fl">0.1</span>)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">70</span>)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">70</span>){</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  a[i]<span class="ot">&lt;-</span><span class="fu">neglogf0.vs.a</span>(nlf0[i])</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>}</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a><span class="fu">plot</span>(nlf0,a,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;-logf0&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-41" class="section level3">
<h3>9.4</h3>
<p><strong>Solution.</strong></p>
<p>Refer to Exercise 3.2, the standard Laplace distribution has density
<span class="math inline">\(f(x)=\frac12e^{-|x|},x\in\mathbb{R}\)</span>.</p>
<p>Compute corresponding acceptance probability <span class="math inline">\(\alpha(x_t,x&#39;)\)</span>:</p>
<p><span class="math inline">\(\alpha(x_t,x&#39;)=min\{\frac{f(x&#39;)g(x_t|x&#39;)}{f(x_t)g(x&#39;|x_t)},1\}=min\{\frac{\frac12e^{-|x&#39;|}}{\frac12e^{-|x_t|}},1\}=min\{e^{-|x&#39;|+|x_t|},1\}\)</span>.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co">#Refer to codes of page 214 in Bayesian Analysis</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>rw.Metropolis<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  <span class="co">#sigma:standard variance of proposal distribution N(xt,sigma2)</span></span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="co">#x0:initial value</span></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  <span class="co">#N:size of random numbers required</span></span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>x0</span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(N)  </span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb96-11"><a href="#cb96-11" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb96-12"><a href="#cb96-12" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y)<span class="sc">+</span><span class="fu">abs</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb96-13"><a href="#cb96-13" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb96-14"><a href="#cb96-14" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb96-15"><a href="#cb96-15" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb96-16"><a href="#cb96-16" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb96-17"><a href="#cb96-17" tabindex="-1"></a>    }</span>
<span id="cb96-18"><a href="#cb96-18" tabindex="-1"></a>  }</span>
<span id="cb96-19"><a href="#cb96-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb96-20"><a href="#cb96-20" tabindex="-1"></a>}</span>
<span id="cb96-21"><a href="#cb96-21" tabindex="-1"></a></span>
<span id="cb96-22"><a href="#cb96-22" tabindex="-1"></a><span class="co">#Set initial values</span></span>
<span id="cb96-23"><a href="#cb96-23" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="fl">2.5</span>,<span class="dv">16</span>)</span>
<span id="cb96-24"><a href="#cb96-24" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">3000</span>;x0<span class="ot">&lt;-</span><span class="dv">25</span></span>
<span id="cb96-25"><a href="#cb96-25" tabindex="-1"></a></span>
<span id="cb96-26"><a href="#cb96-26" tabindex="-1"></a><span class="co">#Derive corresponding chains with rw.Metropolis</span></span>
<span id="cb96-27"><a href="#cb96-27" tabindex="-1"></a>rw1<span class="ot">&lt;-</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb96-28"><a href="#cb96-28" tabindex="-1"></a>rw2<span class="ot">&lt;-</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb96-29"><a href="#cb96-29" tabindex="-1"></a>rw3<span class="ot">&lt;-</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb96-30"><a href="#cb96-30" tabindex="-1"></a>rw4<span class="ot">&lt;-</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="co">#Draw graphs of chains</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#display four graphs together</span></span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>laplace.quantile<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">20</span>),<span class="fu">log</span>(<span class="dv">20</span>))</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>refline<span class="ot">&lt;-</span>laplace.quantile</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>rw<span class="ot">&lt;-</span><span class="fu">cbind</span>(rw1<span class="sc">$</span>x,rw2<span class="sc">$</span>x,rw3<span class="sc">$</span>x,rw4<span class="sc">$</span>x)</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>  <span class="fu">plot</span>(rw[,j],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span>.(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>Find that 1.the first chain is far from convergence; 2.the rate of
convergence becomes higher with higher variance <span class="math inline">\(\sigma\)</span>; 3.the second and the forth chain
is little unstable after convergence; 4.overall, the third chain is
relatively best one.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="co">#Compare rates of acceptance</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Rates of acceptance with sigma=0.05,0.5,2.5,16:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k,rw4<span class="sc">$</span>k)<span class="sc">/</span>N,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Rates of acceptance with sigma=0.05,0.5,2.5,16: 
##  0.9726667 0.817 0.469 0.1056667</code></pre>
<p>Find that the rate of acceptance decreases when the variance <span class="math inline">\(\sigma\)</span> increases.</p>
</div>
<div id="section-42" class="section level3">
<h3>9.7</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co">#Refer to codes of page 227 in Bayesian Analysis</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="co">#Initialize constants and parameters</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">500</span> <span class="co">#length of burn-in</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) <span class="co">#storage of chain of bivariate sample</span></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>rho<span class="ot">&lt;-</span><span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>mu1<span class="ot">&lt;-</span><span class="dv">0</span>;mu2<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span>;sigma2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a><span class="co">#Generate corresponding chain</span></span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>Z[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(mu1,mu2) <span class="co">#initialize</span></span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a>  z2<span class="ot">&lt;-</span>Z[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a>  m1<span class="ot">&lt;-</span>mu1<span class="sc">+</span>rho<span class="sc">*</span>(z2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a>  Z[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb100-18"><a href="#cb100-18" tabindex="-1"></a>  z1<span class="ot">&lt;-</span>Z[i,<span class="dv">1</span>]</span>
<span id="cb100-19"><a href="#cb100-19" tabindex="-1"></a>  m2<span class="ot">&lt;-</span>mu2<span class="sc">+</span>rho<span class="sc">*</span>(z1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb100-20"><a href="#cb100-20" tabindex="-1"></a>  Z[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb100-21"><a href="#cb100-21" tabindex="-1"></a>}</span>
<span id="cb100-22"><a href="#cb100-22" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" tabindex="-1"></a><span class="co">#Plot generated sample after discarding a burn-in sample</span></span>
<span id="cb100-24"><a href="#cb100-24" tabindex="-1"></a>b<span class="ot">&lt;-</span>burn<span class="sc">+</span><span class="dv">1</span>;z<span class="ot">&lt;-</span>Z[b<span class="sc">:</span>N,]</span>
<span id="cb100-25"><a href="#cb100-25" tabindex="-1"></a><span class="fu">plot</span>(z,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(X),<span class="at">ylab=</span><span class="fu">bquote</span>(Y),<span class="at">ylim=</span><span class="fu">range</span>(z[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">colnames</span>(Z)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>lm.gibbs<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span><span class="fu">data.frame</span>(Z))</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Coefficients of linear regression model:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Coefficients of linear regression model:</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>lm.gibbs<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)           x 
##  0.01080103  0.90312608</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated residuals of linear regression model:&quot;</span>,<span class="fu">mean</span>((Z[,<span class="dv">2</span>]<span class="sc">-</span>lm.gibbs<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated residuals of linear regression model: 0.1869978</code></pre>
<p>Easily know that <span class="math inline">\(E(Y-\hat{\beta}_1X-\hat{\beta}_0)^2=E(Y-0.9X)^2=0.19\)</span>.
This theoretical value of residuals is quite close to estimated
residuals.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co">#Check the residuals of the model for normality and constant variance</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>res<span class="ot">&lt;-</span>lm.gibbs<span class="sc">$</span>residuals</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a><span class="fu">qqnorm</span>(res);<span class="fu">qqline</span>(res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-43" class="section level3">
<h3>9.10</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co">#Refer to codes of page 206 in Bayesian Analysis</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>Gelman.Rubin<span class="ot">&lt;-</span><span class="cf">function</span>(psi){</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>  <span class="co">#psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>  <span class="co">#for chain in i-th row of X</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>  psi<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(psi)</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">ncol</span>(psi)</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">nrow</span>(psi)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>  psi.means<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(psi)</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  B<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">var</span>(psi.means) <span class="co">#between variance estimate</span></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>  psi.w<span class="ot">&lt;-</span><span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  W<span class="ot">&lt;-</span><span class="fu">mean</span>(psi.w) <span class="co">#within estimate</span></span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>  v.hat<span class="ot">&lt;-</span>W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(B<span class="sc">/</span>n) <span class="co">#upper variance estimate</span></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>  r.hat<span class="ot">&lt;-</span>v.hat<span class="sc">/</span>W <span class="co">#Gelman Rubin statistic</span></span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a>}</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x,sigma){</span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(x<span class="sc">&lt;</span><span class="dv">0</span>)) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a>}</span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a>rayleigh.MH<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,m,x0){</span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>x0</span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a>    xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb108-29"><a href="#cb108-29" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">1</span>,<span class="at">df=</span>xt)</span>
<span id="cb108-30"><a href="#cb108-30" tabindex="-1"></a>    num<span class="ot">&lt;-</span><span class="fu">f</span>(y,sigma)<span class="sc">*</span><span class="fu">dchisq</span>(xt,<span class="at">df=</span>y)</span>
<span id="cb108-31"><a href="#cb108-31" tabindex="-1"></a>    den<span class="ot">&lt;-</span><span class="fu">f</span>(xt,sigma)<span class="sc">*</span><span class="fu">dchisq</span>(y,<span class="at">df=</span>xt)</span>
<span id="cb108-32"><a href="#cb108-32" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span>num<span class="sc">/</span>den) x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb108-33"><a href="#cb108-33" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb108-34"><a href="#cb108-34" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>xt</span>
<span id="cb108-35"><a href="#cb108-35" tabindex="-1"></a>  }</span>
<span id="cb108-36"><a href="#cb108-36" tabindex="-1"></a>  x</span>
<span id="cb108-37"><a href="#cb108-37" tabindex="-1"></a>}</span>
<span id="cb108-38"><a href="#cb108-38" tabindex="-1"></a></span>
<span id="cb108-39"><a href="#cb108-39" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">4</span>;m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb108-40"><a href="#cb108-40" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span>;b<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb108-41"><a href="#cb108-41" tabindex="-1"></a></span>
<span id="cb108-42"><a href="#cb108-42" tabindex="-1"></a><span class="co">#Choose overdispersed initial values</span></span>
<span id="cb108-43"><a href="#cb108-43" tabindex="-1"></a><span class="co">#x0&lt;-c(1,5,10,15)</span></span>
<span id="cb108-44"><a href="#cb108-44" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb108-45"><a href="#cb108-45" tabindex="-1"></a></span>
<span id="cb108-46"><a href="#cb108-46" tabindex="-1"></a><span class="co">#Generate chains</span></span>
<span id="cb108-47"><a href="#cb108-47" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>m)</span>
<span id="cb108-48"><a href="#cb108-48" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb108-49"><a href="#cb108-49" tabindex="-1"></a>  X[i,]<span class="ot">&lt;-</span><span class="fu">rayleigh.MH</span>(sigma,m,x0[i])</span>
<span id="cb108-50"><a href="#cb108-50" tabindex="-1"></a></span>
<span id="cb108-51"><a href="#cb108-51" tabindex="-1"></a><span class="co">#Compute diagnostic statistics</span></span>
<span id="cb108-52"><a href="#cb108-52" tabindex="-1"></a>psi<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb108-53"><a href="#cb108-53" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb108-54"><a href="#cb108-54" tabindex="-1"></a>  psi[i,]<span class="ot">&lt;-</span>psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb108-55"><a href="#cb108-55" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.257415</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co">#Plot psi for four chains</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i,(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>       <span class="at">xlab=</span>i,<span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="co">#Plot sequence of R.hat statistics</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>rhat<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m)</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  rhat[j]<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="co">#Use coda</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>coda<span class="ot">&lt;-</span><span class="fu">mcmc.list</span>(<span class="fu">as.mcmc</span>(X[<span class="dv">1</span>,]),<span class="fu">as.mcmc</span>(X[<span class="dv">2</span>,]),<span class="fu">as.mcmc</span>(X[<span class="dv">3</span>,]),<span class="fu">as.mcmc</span>(X[<span class="dv">4</span>,]))</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a><span class="fu">gelman.diag</span>(coda)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(coda)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw8.20231115" class="section level1">
<h1>HW8.20231115</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<div id="homework-in-class-8" class="section level3">
<h3>Homework In Class</h3>
<p><em>Denote <span class="math inline">\(X_1,X_2..X_n\ iid\sim
Exp(\lambda)\)</span>. Due to some reason, only know that <span class="math inline">\(X_i\)</span> exists in some interval <span class="math inline">\((u_i,v_i)\)</span> where <span class="math inline">\(u_i&lt;v_i\)</span> are two nonrandom known
constants. These kind of data is called interval censored data.</em></p>
<p><strong>a.</strong></p>
<p><em>Directly maximize the likelihood of the observed data and employ
the EM algorithm to compute the maximum likelihood estimator of <span class="math inline">\(\lambda\)</span>. Prove the EM algorithm converges
to the MLE of the observed data. Moreover its convergence has a linear
rate.</em></p>
<p><strong>b.</strong></p>
<p><em>Set the observed data of <span class="math inline">\((u_i,v_i),i=1,2..n(=10)\)</span> are <span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\)</span>.
Write codes to realize two algorithms mentioned in a. and derive
corresponding numerical solutions for the MLE of <span class="math inline">\(\lambda\)</span>.</em></p>
<p><em>Hint: the likelihood function of the observed data is <span class="math inline">\(L(\lambda)=\prod_{i=1}^nP_{\lambda}(u_i\le X_i\le
v_i)\)</span>.</em></p>
</div>
<div id="section-44" class="section level3">
<h3>11.8</h3>
<p><em>In the Morra game, the set of optimal strategies are not changed
if a constant is subtracted from every entry of the payoff matrix or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute <span class="math inline">\(B&lt;-A+2\)</span>, find the solution of game
<span class="math inline">\(B\)</span> and verify that it is one of the
extreme points (11.12)-(11.15) of the original game <span class="math inline">\(A\)</span>. Also find the value of game <span class="math inline">\(A\)</span> and game <span class="math inline">\(B\)</span>.</em></p>
</div>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="homework-in-class-9" class="section level3">
<h3>Homework In Class</h3>
<p><strong>Solution.</strong></p>
<p><strong>(1)</strong></p>
<p><em>A.Directly Maximize Likelihood Of Observed Data</em></p>
<p>Derive the likelihood of observed data <span class="math inline">\((u_i,v_i),i=1,2..n\)</span>:</p>
<p><span class="math inline">\(L(\lambda;u,v)=\prod_{i=1}^nP_\lambda(u_i\le
x_i\le v_i)=\prod_{i=1}^n\int_{u_i}^{v_i}\lambda e^{-\lambda
x}dx=\prod_{i=1}^n(e^{-\lambda u_i}-e^{-\lambda v_i})\)</span></p>
<p>Then obtain the log-likelihood of observed data <span class="math inline">\((u_i,v_i),i=1,2..n\)</span>:</p>
<p><span class="math inline">\(l(\lambda;u,v)=\sum_{i=1}^nlog(e^{-\lambda
u_i}-e^{-\lambda v_i})\)</span></p>
<p>Moreover compute the first and second derivatives of the
log-likelihood:</p>
<p><span class="math inline">\(l&#39;(\lambda;u,v)=\sum_{i=1}^n\frac{-u_ie^{-\lambda
u_i}+v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}\)</span></p>
<p><span class="math inline">\(l&#39;&#39;(\lambda;u,v)=\sum_{i=1}^n\frac{(u_i^2e^{-\lambda
u_i}-v_i^2e^{-\lambda v_i})(e^{-\lambda u_i}-e^{-\lambda
v_i})-(-u_ie^{-\lambda u_i}+v_ie^{-\lambda v_i})^2}{(e^{-\lambda
u_i}-e^{-\lambda
v_i})^2}=\sum_{i=1}^n\frac{-(u_i-v_i)^2e^{-\lambda(u_i+v_i)}}{(e^{-\lambda
u_i}-e^{-\lambda v_i})^2}\)</span></p>
<p>Easily know that <span class="math inline">\(l(\lambda;u,v)\)</span>
is concave with <span class="math inline">\(l&#39;&#39;(\lambda;u,v)\le0\)</span>. Thus
maximizing the log-likelihood of observed data has global optimal
solution.</p>
<p>Using R functions like ‘optimize’, we can directly obtain the
numerical solution of incomplete log-likelihood maximization.</p>
<p><em>B.Employ EM Algorithm To Obtain MLE</em></p>
<p>Derive the likelihood of complete data <span class="math inline">\((u_i,v_i,x_i),i=1,2..n\)</span>:</p>
<p><span class="math inline">\(L(\lambda;u,v,x)=L(\lambda;x)=\prod_{i=1}^n\lambda
e^{-\lambda x_i}=\lambda^ne^{-n\lambda\bar{x}}\)</span></p>
<p>Then obtain the log-likelihood of complete data <span class="math inline">\((u_i,v_i,x_i),i=1,2..n\)</span>:</p>
<p><span class="math inline">\(l(\lambda;u,v,x)=n\log\lambda-n\lambda\bar{x}\)</span></p>
<p>Compute <span class="math inline">\(Q(\lambda|\hat{\lambda}^{(j)})=E^{x|u,v,\hat{\lambda}^{(j)}}[l(\lambda;u,v,x)]\)</span>:</p>
<p><span class="math inline">\(Q(\lambda|\hat{\lambda}^{(j)})=E^{x|u,v,\hat{\lambda}^{(j)}}[l(\lambda;u,v,x)]=n\log\lambda-\lambda\sum_{i=1}^nE[x_i|u_i,v_i,\hat\lambda^{(j)}]\)</span></p>
<p><span class="math inline">\(=n\log\lambda-\lambda\sum_{i=1}^n\int_{u_i}^{v_i}x\frac{\hat\lambda^{(j)}
e^{-\hat\lambda^{(j)}
x}}{e^{-\hat\lambda^{(j)}u_i}-e^{-\hat\lambda^{(j)}v_i}}dx=n\log\lambda-\lambda\sum_{i=1}^n(\frac{u_ie^{-\hat\lambda^{(j)}u_i}-v_ie^{-\hat\lambda^{(j)}v_i}}{e^{-\hat\lambda^{(j)}u_i}-e^{-\hat\lambda^{(j)}v_i}}+\frac{1}{\hat\lambda^{(j)}})\)</span></p>
<p>Then maximize <span class="math inline">\(Q(\lambda|\lambda^{(j)})\)</span> and obtain the
following iterative formula:</p>
<p><span class="math inline">\(\hat\lambda^{(j+1)}=\hat\lambda^{(j)}\frac{1}{1+\sum_{i=1}^n\hat\lambda^{(j)}\times\frac{u_ie^{-\hat\lambda^{(j)}u_i}-v_ie^{-\hat\lambda^{(j)}v_i}}{e^{-\hat\lambda^{(j)}u_i}-e^{-\hat\lambda^{(j)}v_i}}/n}\)</span></p>
<p>Rewrite this formula and derive:</p>
<p><span class="math inline">\(\frac{1}{\hat\lambda^{(j+1)}}=\frac{1}{\hat\lambda^{(j)}}+\sum_{i=1}^n\frac{u_ie^{-\hat\lambda^{(j)}u_i}-v_ie^{-\hat\lambda^{(j)}v_i}}{e^{-\hat\lambda^{(j)}u_i}-e^{-\hat\lambda^{(j)}v_i}}/n\)</span></p>
<p>Denote <span class="math inline">\(z_j=\frac{1}{\hat\lambda^{(j)}}\)</span>. Then
<span class="math inline">\(z_{j+1}=z_j+\sum_{i=1}^n\frac{u_ie^{-u_i/z_j}-v_ie^{-v_i/z_j}}{e^{-u_i/z_j}-e^{-v_i/z_j}}/n\)</span>.</p>
<p>Define <span class="math inline">\(f(z)=z+\sum_{i=1}^ng(z;u_i,v_i)/n\)</span> and
<span class="math inline">\(g(z;u_i,v_i)=\frac{u_ie^{-u_i/z}-v_ie^{-v_i/z}}{e^{-u_i/z}-e^{-v_i/z}}=u_i-\frac{v_i-u_i}{e^{(v_i-u_i)/z}-1}\)</span>.</p>
<p>Easily derive <span class="math inline">\(g&#39;(z;u_i,v_i)=-\frac{((u_i-v_i)/z)^2e^{(v_i-u_i)/z}}{(e^{(v_i-u_i)/z}-1)^2}\)</span>.</p>
<p>Select enough large <span class="math inline">\(M\)</span> such that
<span class="math inline">\(M\ge\max\{1/\hat\lambda^{(0)},\bar{u}+\sum_{i=1}^n\frac{v_i-u_i}{\log(\frac{v_i-u_i}{u_i}+1)}\}\)</span>.</p>
<p>Then try to prove <span class="math inline">\(f(z)\le M\)</span> if
<span class="math inline">\(z\le M\)</span>. If <span class="math inline">\(z\le M-\bar{u}\)</span>, then <span class="math inline">\(f(z)=z+\sum_{i=1}^ng(z;u_i,v_i)/n\le
M-\bar{u}+\bar{u}=M\)</span> (Note that <span class="math inline">\(g(z;u_i,v_i)\le\lim_{z\to0^+}g(z;u_i,v_i)=u_i\)</span>).
If <span class="math inline">\(z&gt;M-\bar{u}\ge\frac{v_i-u_i}{\log(\frac{v_i-u_i}{\bar{u}}+1)}\)</span>,
then <span class="math inline">\(\frac{v_i-u_i}{e^{\frac{v_i-u_i}{z}}-1}\ge\bar{u}\)</span>.
Hence <span class="math inline">\(f(z)=z+\sum_{i=1}^ng(z;u_i,v_i)/n=z+\bar{u}-\frac1n\sum_{i=1}^n\frac{v_i-u_i}{e^{\frac{v_i-u_i}{z}}-1}\le
z\le M\)</span>.</p>
<p><span class="math inline">\(g&#39;(z;u_i,v_i)\)</span> is continuous
on a compact interval <span class="math inline">\([0,M]\)</span>. Then
there exists <span class="math inline">\(z_{\max}^i\in[0,M]\)</span>
such that <span class="math inline">\(g&#39;(z;u_i,v_i)\le
g&#39;(z_{\max}^i)=k_i&lt;0,\forall z\in[0,M]\)</span>. Thus <span class="math inline">\(g&#39;(z;u_i,v_i)\le k_i&lt;0\)</span>.</p>
<p><span class="math inline">\(g&#39;(z;u_i,v_i)&gt;-1\Leftrightarrow(u_i/z-v_i/z)^2e^{(v_i/z-u_i/z)}&lt;(e^{(v_i-u_i)/z}-1)^2\
\ (u_i&lt;v_i)\)</span></p>
<p><span class="math inline">\(\Leftrightarrow(u_i/z-v_i/z)^2&lt;e^{u_i/z-v_i/z}+e^{v_i/z-u_i/z}-2\
\ (u_i&lt;v_i)\)</span></p>
<p>Denote <span class="math inline">\(w=u_i/z-v_i/z\in\mathbb{R}^-\)</span> and <span class="math inline">\(h(w)=e^w+e^{-w}-w^2-2\)</span>. Compute <span class="math inline">\(h&#39;(w)=e^w-e^{-w}-2w\)</span> and <span class="math inline">\(h&#39;&#39;(w)=e^w+e^{-w}-2&gt;0,w\neq0,h&#39;&#39;(0)=0\)</span>.
With <span class="math inline">\(h&#39;(0)=0\)</span> and <span class="math inline">\(h&#39;&#39;(w)&gt;0,w\neq0,h&#39;&#39;(0)=0\)</span>,
derive <span class="math inline">\(h&#39;(w)&gt;0,w&gt;0,h&#39;(w)&lt;0,w&lt;0,h&#39;(0)=0\)</span>.
Then <span class="math inline">\(h(w)&gt;0,w\neq0,h(0)=0\)</span>. Thus
<span class="math inline">\(g&#39;(z;u_i,v_i)&gt;-1\)</span>.</p>
<p><span class="math inline">\(-1&lt;g&#39;(z;u_i,v_i)\le
k_i&lt;0\Rightarrow
0&lt;f&#39;(z)=1+\sum_{i=1}^ng&#39;(z_i;u_i,v_i)/n\le1+\sum_{i=1}^nk_i/n&lt;1\)</span>.</p>
<p>With fixed point lemma and differential mean value theorem, we
conclude that <span class="math inline">\(f(z)\)</span> has a unique
fixed point <span class="math inline">\(z_{\infty}\)</span> resulting
<span class="math inline">\(z_j\to z_{\infty}\)</span> and thus <span class="math inline">\(\hat\lambda^{(j)}=\frac1{z_j}\to\frac1{z_{\infty}}=\lambda_{\infty}\)</span>.</p>
<p>Further with <span class="math inline">\(f&#39;(z_{\infty})\neq0\)</span>, then <span class="math inline">\(\{z_{j+1}=f(z_j)\}\)</span> is linearly
convergent: <span class="math inline">\(\lim_{j\to\infty}\frac{|z_{j+1}-z_{\infty}|}{|z_j-z_{\infty}|}=\alpha\in(0,\infty)\)</span>.</p>
<p>Finally, we derive the linear convergence of <span class="math inline">\(\{\hat\lambda^{(j)}=\frac1{z_j}\}\)</span> with
the linear convergence of <span class="math inline">\(\{z_{j+1}=f(z_j)\}\)</span>:</p>
<p><span class="math inline">\(\lim_{j\to\infty}\frac{|\hat\lambda^{(j+1)}-\lambda_{\infty}|}{|\hat\lambda^{(j)}-\lambda_{\infty}|}=\lim_{j\to\infty}\frac{|1/z_{j+1}-1/z_{\infty}|}{|1/z_j-1/z_{\infty}|}=\lim_{j\to\infty}\frac{|z_j|}{|z_{j+1}|}\frac{|z_j-z_{\infty}|}{|z_{j+1}-z_{\infty}|}=\frac1\alpha\in(0,\infty)\)</span>.</p>
<p><strong>(2)</strong></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="co">#Compute MLE maximizing log-likelihood of incomplete data</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>loglikelihood.incomplete<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>  lli<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>    lli<span class="ot">&lt;-</span>lli<span class="sc">+</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>  lli</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>}</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a><span class="fu">curve</span>(loglikelihood.incomplete,<span class="at">from=</span><span class="fl">0.01</span>,<span class="at">to=</span><span class="fl">1.01</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6kNtmAABmADpmAGZmOpBmZmZmtttmtv+QOgCQOmaQZgCQkNuQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///+sINXxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKg0lEQVR4nO2da5ujNhKFT5LumXQ2u+NcnHgzbtv//1fGgCWQG1CVVHDKbt4PbtnU5bQeIQRIgMvGLGAL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvgC3AO2AL8A7YArwDtgDvIJaO6PjGE+MRdH9Ob3jtSucdfvybJscfaD9P/xnWSfrtkwO2AO8gFM7/J6pwDELh9NZ1Qufftv1rCGLpiB/+vFwOWxedgr54PX5d+ZkmxScYlJsa2kZBd6Av7oH/7fDynabFJQiF61Cx2buOWx+UglA4/do1ne0olgK2AO+g/dxONSZB92c7WZ0CsbRd7hgFbAHeAVuAd9AXr/3Qy/f9dqqRglg6/vDn4eX76W2roQSEwnn38+VaQZfDdgxLQCic3r61FXTcKigBoRBa0H47W01ALHV90GEbB6WgL16PYmivKm4MAFuAdxAKp1+6trN10ikIhVBB22E+Bd2fPSLbQDEBoRBa0EYK2AK8g764nayOgVjaTlZHQShsJ6vjIBS2k9VxEArbyeo4iCXJyWo3vwGf6b4H+mL+ZPUQRpHHzzOchMK22QtvHCZ2RDwMS1RQ04/fmOrKNeGowNzwImtBinBUoDNsu58bMx1w7MEn+yBxXjYwN2wJFTk5FEjDafb1lYG5oT5cVzmqHnE9UGDYNo/KYSJGixd/dQS94bEdAh0EV+3fv0wOJjFSun0XS1oFqA3Pu+6/njnVmO7KPw4vRgSINa0B1IaSi/a3g5ekBY0J8NQbQW0YWtDUCKfl9NZsFVTQZH6xsIWB3vDYDnJyd1b31z6qpoK89EVQGwrHis0Ja76CZtOLtS0JzA0j719+qqsgF40I5oY95930bghZ0IKsxogV9IZhH8teDBucs06Ey2enNyJx/mh43kkH0fkKUiXmIE4fDQcXezLYVBC5EYmTR8O5fzvFqIK4VSRO3Ru+fxXenDerIOZ+Js7cG75/EXbSJnmDvdbBCnHeaHjeva6Zt8LDBHHaaCjvpE3yDlwKfOoRJ42G8k7aJG+1UyXinL2huJM2yZt6lbnVIM4YDePJ6qqddPQrdSxFnE9suHS4cs9l04kNFw+3biMSJxsYtgOhspn2+lveGS2LI87VG3YXnCvXaojzjnvXuatSqQ3DYX72mrRd3oX87RNFwzBQrJuCJ847GaA6gjCP2tBHC1qtDYnT9IYO+iCrEJZZBoYVRzF93rkYFkGyScwN1wy3QhWJM4gN1w1nFac+wcCwmbZQO31VnDcbyCzSRHy9YTetIzwtcJzsPGlxXo2yJRBHj4aScVB+nrQ4r4BFG5E4djSM46DpClp7lqtpsNLYvWE3Anr/Mt0JrT5P2jZaWeiBYXYctP486eX2MnFglQLCPOmlqkgcVpdfOU/ahAVCaqL2hiZLncR5NTEXCao33FssAhPnZQcVx4yGotW8e+C1bWlTp/zivCoWiCoOGQ0ld1bbJZvNAxfva9PmmvQ09nHFAaOh4N58e5i/TchfezmUdWBxvN7wmL1U1jayboi4/oI640YkjhYNBXdWmS3oYlxF4liqpLEPmpzpoAqnxTK4OJYuKekotkB0cSjDnAuE+xDeLL44UGd4PWzLZ3cYzlHUY5VAHKcgIbWCrBqROEpBOm4FGeUQB/lgmH88DruCbG6+LZiMXkGr3r81yLVguOXSiCPUp1oy3HSe2kRi/85QutzQLm81lVUk9u4Nu+vMx7rZC+K8BlTlEjtHw3C5gz0/aKVkYt9o6GSG2VrZxK7RMBy86x7yJs5rQ3k6sWdveFs3/zh9UJuvNKHYb2BY8fSXpa9Jz6Ve2K0w/krhlksp9ioLv1a45XKKnQaGXiZx6pMWZBW79IZepgGvk1bsEQ29TCQvzKtNLLaPho84UKxILLaPho/dgtSZxea94SP3QW1qVW6x8cDwYY9iJcnFtpqg64fTZpenF1vKQzLCLZe/xPDhdzGNAKndE3XSOgVCsyc6zEdkHZHIKDF88IHiEBjZpIZP04IuIhUCk3vDJ+mDWmBg8dHwKY5iN1BtoDakhCsn11VnNhcYzkfhXZOeBBVbRw3drtUoBcUbxw39rtUoBYXbxg1t3rwmzrsKM3v89JYpQ9pT8BYF6g2ThqLnKK65LNyGqUY08fOc4cxzxgPrLgu3AaqfpwxlE6ge8+VHUPxaY3h52Ndnje5lY7+NeysyPWYLuoyqGvlJ7DvNw74+C4JfZl2lazUYy8JNQPYHsWcdxuHsuO+IMGY06mgqw28F3UvDqE3WTYbo9Vn+SBoRJow+erWfsnGQwEqclwEmymKnLIrXZ7kEo0WxjwDx67Oc0u9lmDa6c+mL1z3o5fs+c9FD+Post+Dur9ghvAw7e1lI9Posx9waEcT2oRBep55dcTj2+iyP16TngdqwORNtKih/ZzX/+qwHAGrD0IIeaq1GOdAbdn3Qc9xZzYMCw3YcWHtn9WEoqKAs0oWbmZh1mxeOPu1w+qP7e/5t+l8/70T3zjIi6jbzKqgbAB1n24bsFVIZEXWbaRXUnmhdd6L5Gsg/piovom4zr4Ku/3zljXmhiLrNxAqqftq2UETdZmYFyXag/JvIMiLqNnMqSPXkhc9YQSq2Cspg87K/RwF6l89YQaqHvH0uwBbgHbAFeAdsAd5B+2n2BKrnA2wB3gFbgHcQCoO9zGI+8NOAWLo95A3fbKaUPwsIhcFD3urW1D0ZCIXBksy6VZlPBkJhsCQz/7zbUY7Dm0ZH7R2kewflDczE/WDYkWKQ4tYHya7Mf6B5RGV8TGXyRe3d6lBVUOLePKhOdu1PAPpiexy7Np6ydVFdC9y/fvyi9r7cpuIUJ3/VJZ8FNmHCrKrb3pl8UXs3pZffNRWUuHutoK9NA7/178kXtXf7VdUHpe5L7WJ1q567HuDWDyRf1N7tHqOqoLt86iPEDOiT1K2bt6wg9TSc1L3pROfe1agCoVD75AXDXaz9Ur6LqTvAWRAKtc/uMOykD+pzwsRd3XxnQSjUtiDbw7yyBSXuXW1ZnQ4glmqf3WE7UFSOpBP3Zfqg+md3HDrvbhhy0IZKvC/qU43EfX/9R6yuSMAoztMCtgDvgC3AO2g/t7sak4AtwDtgC/AO2AK8A7YA74AtwDtgC/AO2AK8A7YA74AtwDtgC/AO2AK8A7YA74AtwDtgC/AO2AK8A7YA74AtwDtgC/AO2AK8A7YA74AtwDtgC/AO2AK8A7YA74AtwDtgC/AO2AIyNLPGqKtrwEstIjxajQZ4qWUcf/zrF6spvSWAmFvGPvNIo4UBM7kIsznzZYCZXMJ591/qjCUQc4s4vPxDfVYIiLklNPPbqSsgwUstopkNXLjCzwbwUj8GYAvwDtgCvAO2AO+ALcA7YAvwDtgCvAO2AO+ALcA7YAvwDtgCvAO2AO+ALcA7YAvwDtgCvAO2AO+ALcA7YAvwDtgCvAO2AO+ALcA7YAvwDtgCvAO2AO/8C2ADllZSoGvSAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">optimize</span>(loglikelihood.incomplete,<span class="at">lower=</span><span class="fl">0.01</span>,<span class="at">upper=</span><span class="fl">0.201</span>,<span class="at">maximum=</span><span class="cn">TRUE</span>)<span class="sc">$</span>maximum</span></code></pre></div>
<pre><code>## [1] 0.07196458</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co">#Compute MLE with EM  </span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>EM.MLE<span class="ot">&lt;-</span><span class="cf">function</span>(u,v,<span class="at">lambda0=</span><span class="dv">1</span>,<span class="at">max.it=</span><span class="dv">500</span>,<span class="at">eps=</span><span class="fl">1e-7</span>){</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="fu">c</span>(lambda0,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max.it){</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>    glambda<span class="ot">&lt;-</span>lambda[<span class="dv">1</span>]<span class="sc">*</span><span class="fu">mean</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda[<span class="dv">1</span>]<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda[<span class="dv">1</span>]<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda[<span class="dv">1</span>]<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda[<span class="dv">1</span>]<span class="sc">*</span>v)))</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>    lambda[<span class="dv">2</span>]<span class="ot">&lt;-</span>lambda[<span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>glambda)</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(lambda[<span class="dv">1</span>]<span class="sc">-</span>lambda[<span class="dv">2</span>])<span class="sc">&lt;</span>eps) <span class="cf">break</span></span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>    lambda[<span class="dv">1</span>]<span class="ot">&lt;-</span>lambda[<span class="dv">2</span>]</span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  }</span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  <span class="fu">c</span>(lambda[<span class="dv">1</span>],<span class="fu">abs</span>(lambda[<span class="dv">1</span>]<span class="sc">-</span>lambda[<span class="dv">2</span>]))</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>}</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a><span class="fu">EM.MLE</span>(u,v)[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>Observe that these two algorithms derive the almost same solution
<span class="math inline">\(\lambda=0.07197\)</span>.</p>
</div>
<div id="section-45" class="section level3">
<h3>11.8</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co">#Refer to codes in section 11.9</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>solve.game<span class="ot">&lt;-</span><span class="cf">function</span>(A){</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>  <span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>  <span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>  <span class="co">#maximize v subject to...</span></span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>  <span class="co">#let x strategies 1:m and put v as extra variable</span></span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a>  <span class="co">#A1 the&lt;=constraints</span></span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a>  min.A<span class="ot">&lt;-</span><span class="fu">min</span>(A);A<span class="ot">&lt;-</span>A<span class="sc">-</span>min.A </span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>  max.A<span class="ot">&lt;-</span><span class="fu">max</span>(A);A<span class="ot">&lt;-</span>A<span class="sc">/</span>max.A</span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">nrow</span>(A);n<span class="ot">&lt;-</span><span class="fu">ncol</span>(A)</span>
<span id="cb121-11"><a href="#cb121-11" tabindex="-1"></a>  it<span class="ot">&lt;-</span>n<span class="sc">^</span><span class="dv">3</span>;a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,m),<span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb121-12"><a href="#cb121-12" tabindex="-1"></a>  A1<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A),<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>,n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb121-13"><a href="#cb121-13" tabindex="-1"></a>  b1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb121-14"><a href="#cb121-14" tabindex="-1"></a>  A3<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,m),<span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb121-15"><a href="#cb121-15" tabindex="-1"></a>  b3<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb121-16"><a href="#cb121-16" tabindex="-1"></a>  sx<span class="ot">&lt;-</span><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">A3=</span>A3,<span class="at">b3=</span>b3,<span class="at">maxi=</span><span class="cn">TRUE</span>,<span class="at">n.iter=</span>it)</span>
<span id="cb121-17"><a href="#cb121-17" tabindex="-1"></a>  <span class="co">#the solution is [x1,x2..xm|value of game]</span></span>
<span id="cb121-18"><a href="#cb121-18" tabindex="-1"></a>  <span class="co">#minimize v subject to...</span></span>
<span id="cb121-19"><a href="#cb121-19" tabindex="-1"></a>  <span class="co">#let y strategies 1:n and put v as extra variable</span></span>
<span id="cb121-20"><a href="#cb121-20" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb121-21"><a href="#cb121-21" tabindex="-1"></a>  A1<span class="ot">&lt;-</span><span class="fu">cbind</span>(A,<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>,m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb121-22"><a href="#cb121-22" tabindex="-1"></a>  b1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb121-23"><a href="#cb121-23" tabindex="-1"></a>  A3<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,n),<span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb121-24"><a href="#cb121-24" tabindex="-1"></a>  b3<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb121-25"><a href="#cb121-25" tabindex="-1"></a>  sy<span class="ot">&lt;-</span><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">A3=</span>A3,<span class="at">b3=</span>b3,<span class="at">maxi=</span><span class="cn">FALSE</span>)</span>
<span id="cb121-26"><a href="#cb121-26" tabindex="-1"></a>  soln<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span>A<span class="sc">*</span>max.A<span class="sc">+</span>min.A,</span>
<span id="cb121-27"><a href="#cb121-27" tabindex="-1"></a>             <span class="st">&quot;x&quot;</span><span class="ot">=</span>sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb121-28"><a href="#cb121-28" tabindex="-1"></a>             <span class="st">&quot;y&quot;</span><span class="ot">=</span>sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb121-29"><a href="#cb121-29" tabindex="-1"></a>             <span class="st">&quot;v&quot;</span><span class="ot">=</span>sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>]<span class="sc">*</span>max.A<span class="sc">+</span>min.A)</span>
<span id="cb121-30"><a href="#cb121-30" tabindex="-1"></a>  soln</span>
<span id="cb121-31"><a href="#cb121-31" tabindex="-1"></a>}</span>
<span id="cb121-32"><a href="#cb121-32" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb121-33"><a href="#cb121-33" tabindex="-1"></a>            <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb121-34"><a href="#cb121-34" tabindex="-1"></a>            <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb121-35"><a href="#cb121-35" tabindex="-1"></a>            <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb121-36"><a href="#cb121-36" tabindex="-1"></a>            <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb121-37"><a href="#cb121-37" tabindex="-1"></a>            <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb121-38"><a href="#cb121-38" tabindex="-1"></a>            <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb121-39"><a href="#cb121-39" tabindex="-1"></a>            <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb121-40"><a href="#cb121-40" tabindex="-1"></a>            <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>),<span class="dv">9</span>,<span class="dv">9</span>)</span>
<span id="cb121-41"><a href="#cb121-41" tabindex="-1"></a>B<span class="ot">&lt;-</span>A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb121-42"><a href="#cb121-42" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb121-43"><a href="#cb121-43" tabindex="-1"></a>sa<span class="ot">&lt;-</span><span class="fu">solve.game</span>(A)</span>
<span id="cb121-44"><a href="#cb121-44" tabindex="-1"></a>sb<span class="ot">&lt;-</span><span class="fu">solve.game</span>(B)</span>
<span id="cb121-45"><a href="#cb121-45" tabindex="-1"></a>sabx<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">cbind</span>(sa<span class="sc">$</span>x,sa<span class="sc">$</span>y,sb<span class="sc">$</span>x,sb<span class="sc">$</span>y),<span class="dv">7</span>)</span>
<span id="cb121-46"><a href="#cb121-46" tabindex="-1"></a><span class="fu">colnames</span>(sabx)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Player1GameA&quot;</span>,<span class="st">&quot;Player2GameA&quot;</span>,<span class="st">&quot;Player1GameB&quot;</span>,<span class="st">&quot;Player2GameB&quot;</span>);sabx</span></code></pre></div>
<pre><code>##    Player1GameA Player2GameA Player1GameB Player2GameB
## x1    0.0000000    0.0000000    0.0000000    0.0000000
## x2    0.0000000    0.0000000    0.0000000    0.0000000
## x3    0.4098361    0.4098361    0.4098361    0.4098361
## x4    0.0000000    0.0000000    0.0000000    0.0000000
## x5    0.3278689    0.3278689    0.3278689    0.3278689
## x6    0.0000000    0.0000000    0.0000000    0.0000000
## x7    0.2622951    0.2622951    0.2622951    0.2622951
## x8    0.0000000    0.0000000    0.0000000    0.0000000
## x9    0.0000000    0.0000000    0.0000000    0.0000000</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Value of game A:&quot;</span>,sa<span class="sc">$</span>v,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Value of game A: 0</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Value of game B:&quot;</span>,sb<span class="sc">$</span>v,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Value of game B: 2</code></pre>
<p>1.Both game A and game B have same extreme points corresponding to
(11.15).</p>
<p>2.Values of game A and game B are 0 and 2.</p>
<p>3.The payoff matrices with positive linear transformation(<span class="math inline">\(B=a*A+b,a&gt;0\)</span>) are equivalent:(1)same
optimal strategies;(2)<span class="math inline">\(v_B=a*v_A+b\)</span>.</p>
</div>
</div>
</div>
<div id="hw9.20231122" class="section level1">
<h1>HW9.20231122</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<div id="advanced-r-section-2.1.3-exercise-4" class="section level3">
<h3>Advanced R Section 2.1.3 Exercise 4</h3>
<p><em>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</em></p>
</div>
<div id="advanced-r-section-2.3.1-exercise-1" class="section level3">
<h3>Advanced R Section 2.3.1 Exercise 1</h3>
<p><em>What does dim() return when applied to a vector?</em></p>
</div>
<div id="advanced-r-section-2.3.1-exercise-2" class="section level3">
<h3>Advanced R Section 2.3.1 Exercise 2</h3>
<p><em>If is.matrix(x) is TRUE, what will is.array(x) return?</em></p>
</div>
<div id="advanced-r-section-11.1.2-exercise-2" class="section level3">
<h3>Advanced R Section 11.1.2 Exercise 2</h3>
<p><em>The function below scales a vector so it falls in the range
[0,1]. How would you apply it to every column of a data frame? How would
you apply it to every numeric column in a data frame?</em></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>scale01<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>  rng<span class="ot">&lt;-</span><span class="fu">range</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>  (x<span class="sc">-</span>rng[<span class="dv">1</span>])<span class="sc">/</span>(rng[<span class="dv">2</span>]<span class="sc">-</span>rng[<span class="dv">1</span>])</span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="advanced-r-section-11.2.5-exercise-1" class="section level3">
<h3>Advanced R Section 11.2.5 Exercise 1</h3>
<p><em>Use vapply() to:</em></p>
<p><em>a) Compute the standard deviation of every column in a numeric
data frame.</em></p>
<p><em>b) Compute the standard deviation of every numeric column in a
mixed data frame.(Hint: you’ll need to use vapply() twice)</em></p>
</div>
<div id="extension-to-statistical-computing-with-r-exercise-9.8" class="section level3">
<h3>Extension To Statistical Computing With R Exercise 9.8</h3>
<p><em>Consider Exercise 9.8.(Hint: Refer to the first example case
studies section)</em></p>
<p><em>a) Write an R function.</em></p>
<p><em>b) Write an Rcpp function.</em></p>
<p><em>c) Compare the computation time of the two functions with the
function “microbenchmark”.</em></p>
</div>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="advanced-r-section-2.1.3-exercise-4-1" class="section level3">
<h3>Advanced R Section 2.1.3 Exercise 4</h3>
<p><strong>Solution.</strong></p>
<p>Lists are fundamentally different from atomic vectors because their
elements can be of any type including lists. unlist() could turn lists
into atomic vectors and as.vector doesn’t work just as the following
example shows.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;list.example</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## list.example</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="fu">list</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## $x
##      [,1] [,2]
## [1,]    0    0
## [2,]    0    0
## 
## $y
## [1] 4 3 2 1</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">unlist(list.example)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## unlist(list.example)</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">list</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 y1 y2 y3 y4 
##  0  0  0  0  4  3  2  1</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">as.vector(lise.example)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## as.vector(lise.example)</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">as.vector</span>(<span class="fu">list</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## $x
##      [,1] [,2]
## [1,]    0    0
## [2,]    0    0
## 
## $y
## [1] 4 3 2 1</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">as.vector doesn&#39;t work</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## as.vector doesn&#39;t work</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">list</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>)),<span class="fu">as.vector</span>(<span class="fu">list</span>(<span class="at">x=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>))))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="advanced-r-section-2.3.1-exercise-1-1" class="section level3">
<h3>Advanced R Section 2.3.1 Exercise 1</h3>
<p><strong>Solution.</strong></p>
<p>dim(vector) returns NULL just as the following example shows.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;vector.example</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## vector.example</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 5 4 3 2 1</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">dim(vector.example)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## dim(vector.example)</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="advanced-r-section-2.3.1-exercise-2-1" class="section level3">
<h3>Advanced R Section 2.3.1 Exercise 2</h3>
<p><strong>Solution.</strong></p>
<p>is.array(x) returns TRUE if is.matrix(x) is TRUE just as the
following example shows. Explanation is given in helping documentation
of is.array: a two-dimensional array is the same thing as a matrix.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;matrix.example</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## matrix.example</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    4    2
## [2,]    3    1</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">is.matrix(matrix.example)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## is.matrix(matrix.example)</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="fu">is.matrix</span>(<span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">is.array(matrix.example)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## is.array(matrix.example)</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">is.array</span>(<span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="advanced-r-section-11.1.2-exercise-2-1" class="section level3">
<h3>Advanced R Section 11.1.2 Exercise 2</h3>
<p><strong>Solution.</strong></p>
<p>Use lapply and as.data.frame with scale01 to each column of a data
frame.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;numeric.dataframe.example</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## numeric.dataframe.example</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>df1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">z=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>));df1</span></code></pre></div>
<pre><code>##   x y z
## 1 1 3 1
## 2 2 2 1
## 3 3 1 1</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a>df1.scale<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(df1[,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(df1)],scale01));df1.scale</span></code></pre></div>
<pre><code>##     x   y   z
## 1 0.0 1.0 NaN
## 2 0.5 0.5 NaN
## 3 1.0 0.0 NaN</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">dataframe.example</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## dataframe.example</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a>df2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">z=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>));df2</span></code></pre></div>
<pre><code>##   x y z
## 1 1 3 a
## 2 2 2 b
## 3 3 1 c</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>df2.scale<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(df2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],scale01)),<span class="at">z=</span>df2[,<span class="dv">3</span>]);df2.scale</span></code></pre></div>
<pre><code>##     x   y z
## 1 0.0 1.0 a
## 2 0.5 0.5 b
## 3 1.0 0.0 c</code></pre>
</div>
<div id="advanced-r-section-11.2.5-exercise-1-1" class="section level3">
<h3>Advanced R Section 11.2.5 Exercise 1</h3>
<p><strong>Solution.</strong></p>
<p><strong>a.</strong></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a>df1;<span class="fu">vapply</span>(df1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   x y z
## 1 1 3 1
## 2 2 2 1
## 3 3 1 1</code></pre>
<pre><code>## x y z 
## 1 1 0</code></pre>
<p><strong>b.</strong></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a>df2;<span class="fu">vapply</span>(df2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   x y z
## 1 1 3 a
## 2 2 2 b
## 3 3 1 c</code></pre>
<pre><code>## x y 
## 1 1</code></pre>
</div>
<div id="extension-to-statistical-computing-with-r-exercise-9.8-1" class="section level3">
<h3>Extension To Statistical Computing With R Exercise 9.8</h3>
<p><strong>Solution.</strong></p>
<p><strong>a.Write an R function</strong></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a>gibbsR<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,n,N){</span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>  mat<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow=</span>N,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a>  mat[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">3</span>;mat[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb182-4"><a href="#cb182-4" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb182-5"><a href="#cb182-5" tabindex="-1"></a>    y<span class="ot">&lt;-</span>mat[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb182-6"><a href="#cb182-6" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb182-7"><a href="#cb182-7" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb182-8"><a href="#cb182-8" tabindex="-1"></a>    mat[i,]<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb182-9"><a href="#cb182-9" tabindex="-1"></a>  }</span>
<span id="cb182-10"><a href="#cb182-10" tabindex="-1"></a>  mat</span>
<span id="cb182-11"><a href="#cb182-11" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>b.Write an Rcpp function</strong></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb183-3"><a href="#cb183-3" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb183-5"><a href="#cb183-5" tabindex="-1"></a>NumericMatrix <span class="fu">gibbsC</span>(double a,double b,int n,int N){</span>
<span id="cb183-6"><a href="#cb183-6" tabindex="-1"></a>  NumericMatrix <span class="fu">mat</span>(N,<span class="dv">2</span>);</span>
<span id="cb183-7"><a href="#cb183-7" tabindex="-1"></a>  double x,y;</span>
<span id="cb183-8"><a href="#cb183-8" tabindex="-1"></a>  <span class="fu">mat</span>(<span class="dv">0</span>,<span class="dv">0</span>)<span class="ot">=</span><span class="dv">3</span>;<span class="fu">mat</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="ot">=</span><span class="fl">0.5</span>;</span>
<span id="cb183-9"><a href="#cb183-9" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i=</span><span class="dv">1</span>;i<span class="sc">&lt;</span>N;i<span class="sc">++</span>){</span>
<span id="cb183-10"><a href="#cb183-10" tabindex="-1"></a>    y<span class="ot">=</span><span class="fu">mat</span>(i<span class="dv">-1</span>,<span class="dv">1</span>); </span>
<span id="cb183-11"><a href="#cb183-11" tabindex="-1"></a>    <span class="fu">mat</span>(i,<span class="dv">0</span>)<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)[<span class="dv">0</span>];</span>
<span id="cb183-12"><a href="#cb183-12" tabindex="-1"></a>    x<span class="ot">=</span><span class="fu">mat</span>(i,<span class="dv">0</span>);</span>
<span id="cb183-13"><a href="#cb183-13" tabindex="-1"></a>    <span class="fu">mat</span>(i,<span class="dv">1</span>)<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb183-14"><a href="#cb183-14" tabindex="-1"></a>  }</span>
<span id="cb183-15"><a href="#cb183-15" tabindex="-1"></a>  <span class="fu">return</span>(mat);</span>
<span id="cb183-16"><a href="#cb183-16" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>c.Compare the computation time of the two functions with the
function “microbenchmark”</strong></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
